---

title: Bayesian Blocks


keywords: fastai
sidebar: home_sidebar

summary: "Partition a light curve with the Bayesian Block algorithm"
description: "Partition a light curve with the Bayesian Block algorithm"
nb_path: "nbs/14_bayesian.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/14_bayesian.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The functions implemented here are:</p>
<ul>
<li><p><a href="/wtlikebayesian.html#get_bb_partition"><code>get_bb_partition</code></a> to perform a BB partition. It requires a "fitness" function to perform an evaluation of the 
likelihoods for a set of sequential cells. There are two such, using the number of counts, and the Kerr likelihood. See the <a href="https://arxiv.org/pdf/1207.5578.pdf">Bayesian Block reference</a>.</p>
<ul>
<li><a href="/wtlikebayesian.html#CountFitness"><code>CountFitness</code></a></li>
<li><a href="/wtlikebayesian.html#LikelihoodFitness"><code>LikelihoodFitness</code></a>, the default</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CountFitness" class="doc_header"><code>class</code> <code>CountFitness</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/bayesian.py#L21" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CountFitness</code>(<strong><code>lc</code></strong>, <strong><code>p0</code></strong>=<em><code>0.05</code></em>) :: <code>FitnessFunc</code></p>
</blockquote>
<p>Adapted version of a astropy.stats.bayesian_blocks.FitnessFunc
Considerably modified to give the <code>fitness function</code> access to the cell data.</p>
<p>Implements the Event model using exposure instead of time.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LikelihoodFitness" class="doc_header"><code>class</code> <code>LikelihoodFitness</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/bayesian.py#L125" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LikelihoodFitness</code>(<strong><code>lc</code></strong>, <strong><code>p0</code></strong>=<em><code>0.05</code></em>, <strong><code>npt</code></strong>=<em><code>50</code></em>) :: <a href="/wtlikebayesian.html#CountFitness"><code>CountFitness</code></a></p>
</blockquote>
<p>Fitness function that uses the full likelihood</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="doc_countfitness" class="doc_header"><code>doc_countfitness</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/bayesian.py#L160" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>doc_countfitness</code>(<strong><code>fitness</code></strong>, <strong><code>light_curve_dict</code></strong>, <strong><code>source_name</code></strong>)</p>
</blockquote>
<h4 id="{class_name}-test-with-source-{source_name}">{class_name} test with source {source_name}<a class="anchor-link" href="#{class_name}-test-with-source-{source_name}"> </a></h4><p>Create object: <code>bbfitter = {class_name}(lc)</code></p>
<p>Object description:   {bbfitter}</p>
<p>Then <code>bbfitter({n})</code> returns the values
    {values}</p>
<p>Finally, the partition algorithm, 'bbfitter.fit()' returns {cffit}</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="get_bb_partition" class="doc_header"><code>get_bb_partition</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/bayesian.py#L185" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>get_bb_partition</code>(<strong><code>config</code></strong>, <strong><code>lc</code></strong>, <strong><code>fitness_class</code></strong>=<em><code>LikelihoodFitness</code></em>, <strong><code>p0</code></strong>=<em><code>0.05</code></em>, <strong><code>key</code></strong>=<em><code>None</code></em>, <strong><code>clear</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Perform Bayesian Block partition of the cells found in a light curve</p>
<ul>
<li>lc : input LightCurve object or DataFrame with fit cells</li>
<li>fitness_class</li>
</ul>
<p>return edges for partition</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

