---

title: Poisson-like likelihood function


keywords: fastai
sidebar: home_sidebar

summary: "Description of the class `Poisson`, and its helper `PoissonFitter`, which are used to parameterize log likelihood curves."
description: "Description of the class `Poisson`, and its helper `PoissonFitter`, which are used to parameterize log likelihood curves."
nb_path: "nbs/06_poisson.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/06_poisson.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Author(s): Eric Wallace, Matthew Kerr, Toby Burnett</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Poisson" class="doc_header"><code>class</code> <code>Poisson</code><a href="" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Poisson</code>(<strong><code>p</code></strong>:<code>array of parameters</code>)</p>
</blockquote>
<p>This is a functor class which returns the log of a three-parameter Poisson-like function used to represent
the flux likelihood. The parameters are, in order:</p>
<p>$s_p$ : flux at peak, if positive; if negative, there is only a limit</p>
<p>$e$ : normalization factor to convert flux to equivalent counts. must be &gt;0</p>
<p>$b$  : background flux: must be &gt;=0</p>
<p>This parameterization is equivalent to that described in William Tompkins' thesis
(arxiv: astro-ph/0202141) and Nolan, et al., 2003,  ApJ 597:615:627.
The functional form is that of a Poisson distribution.</p>
<p>The log likelihood expression is for flux $s&gt;=0$
   $$w(s | s_p,e,b) = e\ (s_p+b) \ \log[ e\ (s+b) ] - e\ s + \mathrm{const}$$
the const is such that $w=0$ at the peak.</p>
<p>A slightly more elegant expression, used in the cdf function, is to define
   $\beta = e b$,  $\mu = e s_p + \beta$, and  $x = e s$.</p>
<p>Then the log likelihood is</p>
<p>$$ f(x | \beta) =  \mu \ \log( x + \beta) - x + \mathrm{const}$$</p>
<p>where the peak is at $x=x_p=\max(0, \mu-\beta)$, and the constant is defined so that $f(x_p)=0$.</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Poisson.from_fit" class="doc_header"><code>Poisson.from_fit</code><a href="__main__.py#L172" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Poisson.from_fit</code>(<strong><code>counts</code></strong>, <strong><code>flux</code></strong>, <strong><code>sig_flux</code></strong>, <strong><code>tol</code></strong>=<em><code>5</code></em>)</p>
</blockquote>
<p>Create a Poisson instance using the fit parameters from an analysis
of a likelihood function.</p>
<ul>
<li>counts -- number of weights</li>
<li>flux -- peak value, in flux units</li>
<li>sig_flux -- its standard deviation, square root of the variance</li>
</ul>
<p>This is relevant if the likelihood is not truncated by the Bayes requirement.</p>
<p>If $s$ and $v$ are the signal rate and its variance, determined by an optimization for $n$ measurements,
so $s$ is large compared with $\sqrt{v}$, then the poisson-like parameters can be determined as follows.</p>
<p>We use the properties of the Poisson distribution
$f(n;\lambda) = \exp(n \log\lambda - \lambda + \mathrm{const})$,
where the parameter $\lambda$ is equal to the expected value of number of occurrences $n$ and
to its variance, and that the function we want is shifted by the background $b$ and scaled by a factor
$k$ so we use $f(k(s-b)| \lambda)$. This implies that for the expected value of $s$, $\lambda = n$,
and $ k(s-b)= k^2 v = n$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># simple test: for 10K counts the error is 1% if no background </span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Poisson</span><span class="o">.</span><span class="n">from_fit</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.02</span> <span class="p">)</span>
<span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;Poisson: mu,beta= 10000.0, 0.0&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Fail: got </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="Poisson.__call__" class="doc_header"><code>Poisson.__call__</code><a href="__main__.py#L40" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>Poisson.__call__</code>(<strong><code>dom</code></strong>)</p>
</blockquote>
<p>Return the value(s) of the fit function for the given domain.</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h3><p>Here we generate and plot several instances, all with the $e$ parameter set to one, so the flux is in counts.</p>
<p>The peak ($s_p$) and  background ($b$) parameters are chosen from the following list:</p>
<p style="margin-left: 5%"><samp>[(10, 5), (10, 0), (-5, 5), (-5, 1)]</samp></p><p>The first two, with the peak at 10, show the effect of background. The last two show an example with a
peak less than zero, so that the Bayesian likelihood peaks at zero, and the effect of background on it.</p>
<figure style="margin-left: 5%" title="Figure 1">  <a href="images/poisson_doc_fig_01.png" title="images/poisson_doc_fig_01.png">    <img src="images/poisson_doc_fig_01.png" alt="Figure 1 at images/poisson_doc_fig_01.png" >   </a>  <figcaption><b>Figure 1</b>. Poisson-like plots</figcaption></figure><hr>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PoissonFitter" class="doc_header"><code>class</code> <code>PoissonFitter</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/poisson.py#L214" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PoissonFitter</code>(<strong><code>func</code></strong>, <strong><code>fmax</code></strong>=<em><code>None</code></em>, <strong><code>scale</code></strong>=<em><code>None</code></em>, <strong><code>tol</code></strong>=<em><code>0.2</code></em>, <strong><code>delta</code></strong>=<em><code>0.0001</code></em>, <strong><code>dd</code></strong>=<em><code>-0.1</code></em>, <strong><code>test_mode</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Helper class to fit a log likelihood function to the Poisson</p>
<h2 id="parameters">parameters<a class="anchor-link" href="#parameters"> </a></h2><ul>
<li>func : function of one parameter</li>
<li>fmax : position of maximum value, or None
<pre><code> if None, estimate using fmin</code></pre>
</li>
<li>scale: float | None
  estimate for scale to use; if None, estimate from derivatime</li>
<li>tol : float
  absolute tolerance in probability amplitude for fit, within default domain out to delta L of 4</li>
<li>delta : float
  value to calculate numerical derivative at zero flux</li>
</ul>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="Usage">Usage<a class="anchor-link" href="#Usage"> </a></h3><p>If <code>func</code> is a log-likelihood function, the parameterized fit object is returned by</p>

<pre><code>fpois = PoissonFitter(func).poiss</code></pre>
<p>Test by fitting to the same functions generated in the  <code>Poisson</code> test/demo,
the  ( $s_p, b$ ) pairs.</p>
<p style="margin-left: 5%"><samp>[(10, 5), (10, 0), (-5, 5), (-5, 0.5)]</samp></p><p>The output shows the maximum error and the fit parameters for each test:</p>
<div style="margin-left: 5%"><pre>error: 2.3e-05, fit: [10.     1.     5.001]<br>error: 5.5e-04, fit: [9.997 1.    0.   ]<br>error: 8.6e-13, fit: [-1.  1.  1.]<br>error: 4.5e-02, fit: [-1.     9.999  1.   ]<br></pre></div><p>Here are plots of the probability, created with <code>PoissonFitter.plot</code>, showing the input function, 
and the points that were used for the evaluation, with the output function as a dashed line.</p>
<figure style="margin-left: 5%" title="Figure 1">  <a href="images/usage_fig_01.png" title="images/usage_fig_01.png">    <img src="images/usage_fig_01.png" alt="Figure 1 at images/usage_fig_01.png" width=600>   </a>  <figcaption><b>Figure 1</b>. Fit examples.</figcaption></figure>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Study-tail-when-a-limit">Study tail when a limit<a class="anchor-link" href="#Study-tail-when-a-limit"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">e</span><span class="o">=</span><span class="mi">10</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Poisson</span><span class="p">([</span><span class="mi">5</span><span class="o">*</span><span class="n">e</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">e</span><span class="p">])</span>
<span class="n">pf</span> <span class="o">=</span> <span class="n">PoissonFitter</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> 
<span class="nb">print</span><span class="p">(</span> <span class="sa">f</span><span class="s1">&#39;error: </span><span class="si">{</span><span class="n">pf</span><span class="o">.</span><span class="n">check</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.1e</span><span class="si">}</span><span class="s1">, fit: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pf</span><span class="o">.</span><span class="n">poiss</span><span class="o">.</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">pf</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>error: 4.4e-04, fit: [49.998  9.916  4.538]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">e</span><span class="o">=</span><span class="mi">10</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Poisson</span><span class="p">([</span><span class="mi">5</span><span class="o">*</span><span class="n">e</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">e</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="o">.</span><span class="n">altpars</span><span class="p">(),</span> <span class="n">p</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># Derive parameters, assuming mu&lt;0</span>
<span class="kn">from</span> <span class="nn">scipy.misc</span> <span class="kn">import</span> <span class="n">derivative</span>
<span class="n">g</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="p">[</span><span class="n">derivative</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>

<span class="n">beta</span><span class="o">=-</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">g</span><span class="o">/</span><span class="n">e</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="n">e</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">beta</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">g</span><span class="o">/</span><span class="n">e</span><span class="p">)</span>
<span class="n">pars</span> <span class="o">=</span> <span class="p">[(</span><span class="n">mu</span><span class="o">-</span><span class="n">beta</span><span class="p">)</span><span class="o">/</span><span class="n">e</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">beta</span><span class="o">/</span><span class="n">e</span><span class="p">]</span> 
<span class="n">pars</span><span class="p">,</span> <span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="n">beta</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Poisson: mu,beta= 510.0, 10.0 (10, 10.0, 510.0) [50, 10, 1.0]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>([49.999904510304965, 10, 1.0001000868166177],
 (510.0000459712158, 10.001000868166177))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Check-high-statistics,-no-background">Check high statistics, no background<a class="anchor-link" href="#Check-high-statistics,-no-background"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">mu</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Poisson</span><span class="p">([</span><span class="n">mu</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span> <span class="sa">f</span><span class="s1">&#39;Input: mu = </span><span class="si">{</span><span class="n">mu</span><span class="si">:</span><span class="s1">-8.0f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Fit:   </span><span class="si">{</span><span class="n">PoissonFitter</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span><span class="o">.</span><span class="n">poiss</span><span class="si">}</span><span class="s1">&#39;</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Input: mu =      100	Fit:   Poisson: mu,beta= 100.0, 0.0
Input: mu =     1000	Fit:   Poisson: mu,beta= 1000.3, 0.1
Input: mu =    10000	Fit:   Poisson: mu,beta= 10021.4, 10.7
Input: mu =   100000	Fit:   Poisson: mu,beta= 114749.9, 7628.5
Input: mu =  1000000	Fit:   Poisson: mu,beta= 1030016.1, 15119.3
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">Poisson</span><span class="p">([</span><span class="mi">10000</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span> <span class="p">;</span> <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">pf</span> <span class="o">=</span> <span class="n">PoissonFitter</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">pf</span><span class="o">.</span><span class="n">poiss</span><span class="o">.</span><span class="n">p</span>

<span class="n">pf</span><span class="o">.</span><span class="n">poiss</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">pf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mf">1e5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Poisson: mu,beta= 10100.0, 100.0
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>([9999.997554752043, 0.9974355313909493, 74.10298197458243],
 [9999.997554752043, 0.9994459695779796, 94.40413079520135])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="mf">1.</span><span class="o">+</span><span class="mf">0.00566</span><span class="p">)</span><span class="o">**</span><span class="mi">12</span><span class="o">-</span><span class="mi">1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.07007475296860632</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="mi">7</span><span class="o">/</span><span class="mi">12</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.5833333333333334</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

