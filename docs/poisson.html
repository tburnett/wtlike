---

title: Poisson-like likelihood function


keywords: fastai
sidebar: home_sidebar

summary: "Description of the class `Poisson`, and its helper `PoissonFitter`, which are used to parameterize log likelihood curves."
description: "Description of the class `Poisson`, and its helper `PoissonFitter`, which are used to parameterize log likelihood curves."
nb_path: "nbs/06_poisson.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/06_poisson.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Author(s): Eric Wallace, Matthew Kerr, Toby Burnett</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Poisson" class="doc_header"><code>class</code> <code>Poisson</code><a href="" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Poisson</code>(<strong><code>p</code></strong>:<code>array of parameters</code>)</p>
</blockquote>
<p>This is a functor class which returns the log of a three-parameter Poisson-like function used to represent
the flux likelihood. The parameters are, in order:</p>
<p>$s_p$ : flux at peak, the maximum likelihood, if positive; if negative, there is a limit</p>
<p>$e$ : normalization factor to convert flux to equivalent counts. must be &gt;0</p>
<p>$b$  : background flux: must be &gt;=0</p>
<p>This parameterization is equivalent to that described in William Tompkins' thesis
(arxiv: astro-ph/0202141) and Nolan, et al., 2003,  ApJ 597:615:627.
The functional form is that of a Poisson distribution.</p>
<p>The log likelihood expression is for flux $s&gt;=0$
   $$w(s | s_p,e,b) = e\ \big[\  (s_p+b) \ \log( s+b ) - s\ \big] + \mathrm{const}$$
the const is conventionally defined such that $w=0$ at the peak.</p>
<p>for s_p &gt;&gt; b, the solution can be expressed as</p>
$$ s = s_p \pm \sqrt{(s_p+b)/e}$$<p>A slightly more elegant expression, used in the cdf function, is to define
   $\beta = e b$,  $\mu = e s_p + \beta$, and  $x = e s$.</p>
<p>Then the log likelihood is</p>
<p>$$ f(x | \beta) =  \mu \ \log( x + \beta) - x + \mathrm{const}$$</p>
<p>where the peak is at $x=x_p=\max(0, \mu-\beta)$, and the constant is defined so that $f(x_p)=0$.</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Poisson.from_fit" class="doc_header"><code>Poisson.from_fit</code><a href="__main__.py#L177" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Poisson.from_fit</code>(<strong><code>counts</code></strong>, <strong><code>flux</code></strong>, <strong><code>sig_flux</code></strong>, <strong><code>tol</code></strong>=<em><code>5</code></em>)</p>
</blockquote>
<p>Create a Poisson instance using the fit parameters from an analysis
of a likelihood function.</p>
<ul>
<li>counts -- number of weights</li>
<li>flux -- peak value, in flux units</li>
<li>sig_flux -- its standard deviation, square root of the variance</li>
</ul>
<p>This is relevant if the likelihood is not truncated by the Bayes requirement.</p>
<p>If $s$ and $v$ are the signal rate and its variance, determined by an optimization for $n$ measurements,
so $s$ is large compared with $\sqrt{v}$, then the poisson-like parameters can be determined as follows.</p>
<p>We use the properties of the Poisson distribution
$f(n;\lambda) = \exp(n \log\lambda - \lambda + \mathrm{const})$,
where the parameter $\lambda$ is equal to the expected value of number of occurrences $n$ and
to its variance, and that the function we want is shifted by the background $b$ and scaled by a factor
$k$ so we use $f(k(s-b)| \lambda)$. This implies that for the expected value of $s$, $\lambda = n$,
and $ k(s-b)= k^2 v = n$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># simple test: for 10K counts the error is 1% if no background </span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Poisson</span><span class="o">.</span><span class="n">from_fit</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.02</span> <span class="p">)</span>
<span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;Poisson: mu,beta= 10000.0, 0.0&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Fail: got </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="Poisson.__call__" class="doc_header"><code>Poisson.__call__</code><a href="__main__.py#L45" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>Poisson.__call__</code>(<strong><code>dom</code></strong>)</p>
</blockquote>
<p>Return the value(s) of the fit function for the given domain.</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h3><p>Here we generate and plot several instances, all with the $e$ parameter set to one, so the flux is in counts.</p>
<p>The peak ($s_p$) and  background ($b$) parameters are chosen from the following list:</p>
<p style="margin-left: 5%"><samp>[(10, 5), (10, 0), (-5, 5), (-5, 1)]</samp></p><p>The first two, with the peak at 10, show the effect of background. The last two show an example with a
peak less than zero, so that the Bayesian likelihood peaks at zero, and the effect of background on it.</p>
<figure style="margin-left: 5%" title="Figure 1">  <a href="images/poisson_doc_fig_01.png" title="images/poisson_doc_fig_01.png">    <img src="images/poisson_doc_fig_01.png" alt="Figure 1 at images/poisson_doc_fig_01.png" >   </a>  <figcaption><b>Figure 1</b>. Poisson-like plots</figcaption></figure><hr>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PoissonFitter" class="doc_header"><code>class</code> <code>PoissonFitter</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/poisson.py#L219" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PoissonFitter</code>(<strong><code>func</code></strong>, <strong><code>fmax</code></strong>=<em><code>None</code></em>, <strong><code>scale</code></strong>=<em><code>None</code></em>, <strong><code>tol</code></strong>=<em><code>0.2</code></em>, <strong><code>delta</code></strong>=<em><code>0.0001</code></em>, <strong><code>dd</code></strong>=<em><code>-0.1</code></em>, <strong><code>test_mode</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Helper class to fit a log likelihood function to the Poisson</p>
<h2 id="parameters">parameters<a class="anchor-link" href="#parameters"> </a></h2><ul>
<li>func : function of one parameter</li>
<li>fmax : position of maximum value, or None
<pre><code> if None, estimate using fmin</code></pre>
</li>
<li>scale: float | None
  estimate for scale to use; if None, estimate from derivatime</li>
<li>tol : float
  absolute tolerance in probability amplitude for fit, within default domain out to delta L of 4</li>
<li>delta : float
  value to calculate numerical derivative at zero flux</li>
</ul>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="Usage">Usage<a class="anchor-link" href="#Usage"> </a></h3><p>If <code>func</code> is a log-likelihood function, the parameterized fit object is returned by</p>

<pre><code>fpois = PoissonFitter(func).poiss</code></pre>
<p>Test by fitting to the same functions generated in the  <code>Poisson</code> test/demo,
the  ( $s_p, b$ ) pairs.</p>
<p style="margin-left: 5%"><samp>[(10, 5), (10, 0), (-5, 5), (-5, 0.5)]</samp></p><p>The output shows the maximum error and the fit parameters for each test:</p>
<div style="margin-left: 5%;"><pre>error: 2.3e-05, fit: [10.     1.     5.001]<br>error: 5.6e-04, fit: [9.997 1.    0.   ]<br>error: 8.6e-13, fit: [-1.  1.  1.]<br>error: 4.5e-02, fit: [-1.     9.999  1.   ]<br></pre></div><p>Here are plots of the probability, created with <code>PoissonFitter.plot</code>, showing the input function, 
and the points that were used for the evaluation, with the output function as a dashed line.</p>
<figure style="margin-left: 5%" title="Figure 1">  <a href="images/usage_fig_01.png" title="images/usage_fig_01.png">    <img src="images/usage_fig_01.png" alt="Figure 1 at images/usage_fig_01.png" width=600>   </a>  <figcaption><b>Figure 1</b>. Fit examples.</figcaption></figure>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Study-tail-when-a-limit">Study tail when a limit<a class="anchor-link" href="#Study-tail-when-a-limit"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">e</span><span class="o">=</span><span class="mi">10</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Poisson</span><span class="p">([</span><span class="mi">5</span><span class="o">*</span><span class="n">e</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">e</span><span class="p">])</span>
<span class="n">pf</span> <span class="o">=</span> <span class="n">PoissonFitter</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> 
<span class="nb">print</span><span class="p">(</span> <span class="sa">f</span><span class="s1">&#39;error: </span><span class="si">{</span><span class="n">pf</span><span class="o">.</span><span class="n">check</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.1e</span><span class="si">}</span><span class="s1">, fit: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pf</span><span class="o">.</span><span class="n">poiss</span><span class="o">.</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">pf</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>error: 4.4e-04, fit: [49.998  9.916  4.538]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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miSEEGLNmjXi888/r2KDXq+3mZ6aKmbOnGnv77vvvhNms1kMHjxYGI1GMW/ePPHBB7aF2QkTJoiMjAzx8ssvi9dee00IIWrt22AwiLi4ODF58mRx8uRJe58lJrNIuZov8vVVr5XS/AtC5BwTJv2Nen6Z+nHVwqXDEebo0aP07NmT7t274+3tzfTp09m5c2eVMoqiUFRUhBCC4uJiWrdujZeXXOJxhvfff58RI0ZQUFDApEmTUBSFoKAggoKCatyGrV69mieffJKEhASys7NZsWIFa9asYf78+fU6blaPcFm9/+HDh7Nw4cIqUezvv/9+tFot4eHhZGdn249BVcfIupwgL1y4gJ+fH6NHj6akpITocqdKAE1pFn180/Cz5laxRdHa5jTC0vx2XjoUTF3pLCrz1FNP8dNPP9GxY0ciIiJ46623HLqU35HMFHX/61kpan7PhNrL1MOcOXPYv38/69evR6vVYrVauXXrFrdu3aox0Y+OjmbLli3Ex8ezZcsWwsPD2bRpEwkJCbzxxht1Om7WF5HynXfeITk5mY0bN1Y5l5KSgsVi4fLly4SGhtqPQVXHyLqcIHv06EFWVhYHDhyga9euVWI/C6sJL8WCplpUTU159P7muPPS4TBQ/YuFmiFJv/rqK6Kjo0lKSuLixYuMHj2a2NhYe1jTCmR+mNopKyur0c+LL77I6NGjEUKwcuVKTCYTQghMJhOLFi0iPT0do9HIxo0beemllzh69CjFxcWsXbuWIUOGsGPHDmJjY2nfvj2///3v+f777+19mM22tY/K/Q0YMIDY2FiGDRtm70cIwUcffcSzzz5rz0BntVpJSkpi/fr1xMbGEhoaisVioaysDJPJxIQJE2r0PW/ePF5//XW6dOnCo48+ys6dO20B7CfH0qODPwJNFVsUykdUq7HR372r8sM4nMN8//33YsyYMfb3r732mv1+tYLx48eLgwcP2t+PGDFCHDlypN5278g5zC+MijlTZebNmydSU1NVad+Ye1aInGPCarpV9USZwTaHyUlpfNuemsM8+OCDpKamkpaWhslk4qOPPmLSpElVynTp0oVvvvkGsCVR/fnnn+nevXuD1S35ZVLhFqNodFVPlM9htJTZki01Ixzeknl5efH2228zduxYLBYLCxYsoG/fvvYts4sXL+all15i/vz5REREIIRg7dq1tGnTxkHL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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">e</span><span class="o">=</span><span class="mi">10</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Poisson</span><span class="p">([</span><span class="mi">5</span><span class="o">*</span><span class="n">e</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">e</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="o">.</span><span class="n">altpars</span><span class="p">(),</span> <span class="n">p</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># Derive parameters, assuming mu&lt;0</span>
<span class="kn">from</span> <span class="nn">scipy.misc</span> <span class="kn">import</span> <span class="n">derivative</span>
<span class="n">g</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="p">[</span><span class="n">derivative</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>

<span class="n">beta</span><span class="o">=-</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">g</span><span class="o">/</span><span class="n">e</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="n">e</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">beta</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">g</span><span class="o">/</span><span class="n">e</span><span class="p">)</span>
<span class="n">pars</span> <span class="o">=</span> <span class="p">[(</span><span class="n">mu</span><span class="o">-</span><span class="n">beta</span><span class="p">)</span><span class="o">/</span><span class="n">e</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">beta</span><span class="o">/</span><span class="n">e</span><span class="p">]</span> 
<span class="n">pars</span><span class="p">,</span> <span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="n">beta</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Poisson: mu,beta= 510.0, 10.0 (10, 10.0, 510.0) [50, 10, 1.0]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>([49.999904510304965, 10, 1.0001000868166177],
 (510.0000459712158, 10.001000868166177))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Check-high-statistics,-no-background">Check high statistics, no background<a class="anchor-link" href="#Check-high-statistics,-no-background"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">mu</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Poisson</span><span class="p">([</span><span class="n">mu</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span> <span class="sa">f</span><span class="s1">&#39;Input: mu = </span><span class="si">{</span><span class="n">mu</span><span class="si">:</span><span class="s1">-8.0f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Fit:   </span><span class="si">{</span><span class="n">PoissonFitter</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span><span class="o">.</span><span class="n">poiss</span><span class="si">}</span><span class="s1">&#39;</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Input: mu =      100	Fit:   Poisson: mu,beta= 100.0, 0.0
Input: mu =     1000	Fit:   Poisson: mu,beta= 1000.2, 0.1
Input: mu =    10000	Fit:   Poisson: mu,beta= 10048.9, 24.5
Input: mu =   100000	Fit:   Poisson: mu,beta= 118159.8, 9458.4
Input: mu =  1000000	Fit:   Poisson: mu,beta= 1065567.1, 33304.8
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">Poisson</span><span class="p">([</span><span class="mi">10000</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span> <span class="p">;</span> <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">pf</span> <span class="o">=</span> <span class="n">PoissonFitter</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">pf</span><span class="o">.</span><span class="n">poiss</span><span class="o">.</span><span class="n">p</span>

<span class="n">pf</span><span class="o">.</span><span class="n">poiss</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">pf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mf">1e5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Poisson: mu,beta= 10100.0, 100.0
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>([9999.997554752043, 0.9954022047613839, 53.572052549698405],
 [9999.997554752043, 0.9987684274333115, 87.56296238555251])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

