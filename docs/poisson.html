---

title: Poisson-like likelihood function


keywords: fastai
sidebar: home_sidebar

summary: "Description of the class `Poisson`, and its helper `PoissonFitter`, which are used to parameterize log likelihood curves."
description: "Description of the class `Poisson`, and its helper `PoissonFitter`, which are used to parameterize log likelihood curves."
nb_path: "nbs/06_poisson.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/06_poisson.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Author(s): Eric Wallace, Matthew Kerr, Toby Burnett</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Poisson" class="doc_header"><code>class</code> <code>Poisson</code><a href="" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Poisson</code>(<strong><code>p</code></strong>:<code>array of parameters</code>)</p>
</blockquote>
<p>This is a functor class which returns the log of a three-parameter Poisson-like function used to represent
the flux likelihood. The parameters are, in order:</p>
<p>$s_p$ : flux at peak, if positive; if negative, there is only a limit</p>
<p>$e$ : normalization factor to convert flux to equivalent counts. must be &gt;0</p>
<p>$b$  : background flux: must be &gt;=0</p>
<p>This parameterization is equivalent to that described in William Tompkins' thesis
(arxiv: astro-ph/0202141) and Nolan, et al., 2003,  ApJ 597:615:627.
The functional form is that of a Poisson distribution.</p>
<p>The log likelihood expression is for flux $s&gt;=0$
   $$w(s | s_p,e,b) = e\ (s_p+b) \ \log[ e\ (s+b) ] - e\ s + \mathrm{const}$$
the const is such that $w=0$ at the peak.</p>
<p>A slightly more elegant expression, used in the cdf function, is to define
   $\beta = e b$,  $\mu = e s_p + \beta$, and  $x = e s$.</p>
<p>Then the log likelihood is</p>
<p>$$ f(x | \beta) =  \mu \ \log( x + \beta) - x + \mathrm{const}$$</p>
<p>where the peak is at $x=x_p=\max(0, \mu-\beta)$, and the constant is defined so that $f(x_p)=0$.</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="Poisson.from_fit" class="doc_header"><code>Poisson.from_fit</code><a href="__main__.py#L173" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>Poisson.from_fit</code>(<strong><code>counts</code></strong>, <strong><code>flux</code></strong>, <strong><code>sig_flux</code></strong>, <strong><code>tol</code></strong>=<em><code>5</code></em>)</p>
</blockquote>
<p>Create a Poisson instance using the fit parameters from an analysis
of a likelihood function.</p>
<ul>
<li>counts -- number of weights</li>
<li>flux -- peak value, in flux units</li>
<li>sig_flux -- its standard deviation, square root of the variance</li>
</ul>
<p>This is relevant if the likelihood is not truncated by the Bayes requirement.</p>
<p>If $s$ and $v$ are the signal rate and its variance, determined by an optimization for $n$ measurements,
so $s$ is large compared with $\sqrt{v}$, then the poisson-like parameters can be determined as follows.</p>
<p>We use the properties of the Poisson distribution
$f(n;\lambda) = \exp(n \log\lambda - \lambda + \mathrm{const})$,
where the parameter $\lambda$ is equal to the expected value of number of occurrences $n$ and
to its variance, and that the function we want is shifted by the background $b$ and scaled by a factor
$k$ so we use $f(k(s-b)| \lambda)$. This implies that for the expected value of $s$, $\lambda = n$,
and $ k(s-b)= k^2 v = n$.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># simple test: for 10K counts the error is 1% if no background </span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Poisson</span><span class="o">.</span><span class="n">from_fit</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.02</span> <span class="p">)</span>
<span class="k">assert</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;Poisson: mu,beta= 10000.0, 0.0&#39;</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Fail: got </span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="Poisson.__call__" class="doc_header"><code>Poisson.__call__</code><a href="__main__.py#L41" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>Poisson.__call__</code>(<strong><code>dom</code></strong>)</p>
</blockquote>
<p>Return the value(s) of the fit function for the given domain.</p>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="Examples">Examples<a class="anchor-link" href="#Examples"> </a></h3><p>Here we generate and plot several instances, all with the $e$ parameter set to one, so the flux is in counts.</p>
<p>The peak ($s_p$) and  background ($b$) parameters are chosen from the following list:</p>
<p style="margin-left: 5%"><samp>[(10, 5), (10, 0), (-5, 5), (-5, 1)]</samp></p><p>The first two, with the peak at 10, show the effect of background. The last two show an example with a
peak less than zero, so that the Bayesian likelihood peaks at zero, and the effect of background on it.</p>
<figure style="margin-left: 5%" title="Figure 1">  <a href="images/poisson_doc_fig_01.png" title="images/poisson_doc_fig_01.png">    <img src="images/poisson_doc_fig_01.png" alt="Figure 1 at images/poisson_doc_fig_01.png" >   </a>  <figcaption><b>Figure 1</b>. Poisson-like plots</figcaption></figure><hr>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PoissonFitter" class="doc_header"><code>class</code> <code>PoissonFitter</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/poisson.py#L215" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PoissonFitter</code>(<strong><code>func</code></strong>, <strong><code>fmax</code></strong>=<em><code>None</code></em>, <strong><code>scale</code></strong>=<em><code>None</code></em>, <strong><code>tol</code></strong>=<em><code>0.2</code></em>, <strong><code>delta</code></strong>=<em><code>0.0001</code></em>, <strong><code>dd</code></strong>=<em><code>-0.1</code></em>, <strong><code>test_mode</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Helper class to fit a log likelihood function to the Poisson</p>
<h2 id="parameters">parameters<a class="anchor-link" href="#parameters"> </a></h2><ul>
<li>func : function of one parameter</li>
<li>fmax : position of maximum value, or None
<pre><code> if None, estimate using fmin</code></pre>
</li>
<li>scale: float | None
  estimate for scale to use; if None, estimate from derivatime</li>
<li>tol : float
  absolute tolerance in probability amplitude for fit, within default domain out to delta L of 4</li>
<li>delta : float
  value to calculate numerical derivative at zero flux</li>
</ul>

</div>

</div>

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="Usage">Usage<a class="anchor-link" href="#Usage"> </a></h3><p>If <code>func</code> is a log-likelihood function, the parameterized fit object is returned by</p>

<pre><code>fpois = PoissonFitter(func).poiss</code></pre>
<p>Test by fitting to the same functions generated in the  <code>Poisson</code> test/demo,
the  ( $s_p, b$ ) pairs.</p>
<p style="margin-left: 5%"><samp>[(10, 5), (10, 0), (-5, 5), (-5, 0.5)]</samp></p><p>The output shows the maximum error and the fit parameters for each test:</p>
<div style="margin-left: 5%"><pre>error: 2.3e-05, fit: [10.     1.     5.001]<br>error: 5.5e-04, fit: [9.997 1.    0.   ]<br>error: 8.6e-13, fit: [-1.  1.  1.]<br>error: 4.5e-02, fit: [-1.     9.999  1.   ]<br></pre></div><p>Here are plots of the probability, created with <code>PoissonFitter.plot</code>, showing the input function, 
and the points that were used for the evaluation, with the output function as a dashed line.</p>
<figure style="margin-left: 5%" title="Figure 1">  <a href="images/usage_fig_01.png" title="images/usage_fig_01.png">    <img src="images/usage_fig_01.png" alt="Figure 1 at images/usage_fig_01.png" width=600>   </a>  <figcaption><b>Figure 1</b>. Fit examples.</figcaption></figure>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Tests">Tests<a class="anchor-link" href="#Tests"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Study-tail-when-a-limit">Study tail when a limit<a class="anchor-link" href="#Study-tail-when-a-limit"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">e</span><span class="o">=</span><span class="mi">10</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Poisson</span><span class="p">([</span><span class="mi">5</span><span class="o">*</span><span class="n">e</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">e</span><span class="p">])</span>
<span class="n">pf</span> <span class="o">=</span> <span class="n">PoissonFitter</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> 
<span class="nb">print</span><span class="p">(</span> <span class="sa">f</span><span class="s1">&#39;error: </span><span class="si">{</span><span class="n">pf</span><span class="o">.</span><span class="n">check</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">.1e</span><span class="si">}</span><span class="s1">, fit: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">pf</span><span class="o">.</span><span class="n">poiss</span><span class="o">.</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">pf</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>error: 4.4e-04, fit: [49.998  9.916  4.538]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAM4AAADKCAYAAADtjn/SAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4xLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy8li6FKAAAgAElEQVR4nO2deVyU5fr/3zPDsA2LyiKKBuaWxxRL01xQME9uueQplxQlU8rq+/2eU33tlOZSVtLu72SWWmpJvVostQ3NELe+llqhoJYbLuAGKMuwzHb//hiYRGZggGdmUO/369XL4Znrue5rYD7dz3M/131dKiGEQCKR1Au1pwOQSK5FpHAkkgYghSORNAApHImkAUjhSCQNQApHImkAXp4OwBEhISG0a9fO02FIrgOMRiNarbZB52ZnZ5OXl1fjeJMVTps2bdi7d6+nw5BcB+Tm5tK6desGndurVy+7x+WlmkTSAKRwJJIG4NSl2ttvv83q1as5cOAAkyZNYvXq1Q5t33zzTZKTkykrK+Mf//gHy5Ytw8fHR6l4PcLly5fJy8vDaDR6OhRJAzCbzRQWFtZpp9VqCQ0NpVmzZnXaOiWc1q1bM3fuXDZt2kRZWZlDu02bNrF48WLS0tJo3bo19957L/Pnz2fx4sXODNNkOXv2LNHR0fj6+qJSqTwdjqSeGAwGvL29a7URQlBeXk52drZTwnHqUm3cuHGMHTuWkJCQWu3WrFnDQw89RNeuXWnevDnPPfdcrbPTtYSfn58UzXWMSqXCz8/PaXtFV9WysrIYM2aM7eeYmBjOnz9Pfn5+DdEtX76c5cuXO/R18eJFcnNzlQyvwZjNZgwGg8vH2bZtG2lpaSxcuLBRflavXk1iYmK1Y0IIxo4dS0lJCZs3b0aj0TTa95NPPskrr7zSYF+OEBX5qIwFoLsZVI33XZ+/n9lsdup7p6hwSkpKCA4Otv1c9bq4uLiGcJKSkkhKSnLoKyYmpsFLiEpTWFhY51SvBFqtFo1G0+ixPvzwwxq/29zcXIKDg/n+++8V8/2f//ynUb4cUpwDgMWUj1rXptHunLlUq0Kj0Tj1vVN0VS0gIICioiLbz1WvAwMDlRzmhiAmJoapU6cSExPD77//bjs2adIkevbsyZ49ewAYMGAAYH1Ql5iYyMaNGzlw4ABxcXH88MMPNn+zZ89m69atzJgxgwULFrBlyxYAEhMTyc7OZvXq1UyaNIkRI0YwYsQIhBDo9Xruu+8+Bg0axIMPPljDd1xcHCaTiVOnTjF48GD69+9PcnIyAAsWLGDGjBkMGTKEGTNm1Ouzl6iaA2AWTXfRV9EZp2vXrmRkZDB+/HgAMjIyaNmyZZ33RtcSC7/O4mBuUd2GtfC31kHMH9W1Vptz587x888/s2/fPtasWUOPHj04ffo0u3btorCwkIcffphvvvmmxnmjR4+mW7dupKenVzu+aNEiAFauXMmCBQvsjhkeHs4nn3zCzJkz2b9/P2lpadx9990kJSVhsVhQq9XVfL/44osAJCcns3DhQmJjYxk6dCgJCQmA9fuwcuVK7r77bi5fvuzUTTeAUVif8lssTXcV0ylJm0wmysvLMZvNmM1mysvLMZlMNeymTp3K+++/z8GDB7l06RKLFi2qca0tcY4OHTrg6+tLZGQkly9fth0LCAggMjKyxvJqfTbyXrnIceV5t956K4BtzD///JN+/foBoFY7/qocO3aM22+/HYDbbruNEydOVPPXunVrp5aDqzBYKu9rLK6/r2woTs04ixYtqnbDunbtWubPn8/06dP529/+xsGDB7npppsYNmwYs2fPJj4+3vYcp7E3uk2NumYKpbD35T569Ch6vZ7CwkKCgoIAKC8vB+DAgQN2z7VHcHAwZ8+eRQhBVlaWwzE7d+7M7t27ufXWW20zjj3fN998M/v27WPgwIH89ttv/Nd//ZfDz1AnZgMt1Wet51/rwlmwYIHD6b2kpKTaz0888QRPPPFEowOT1KRt27ZMnz6do0eP8s477wAwcuRIBgwYQJ8+fWx2vXv3ZuzYsTz55JPExsbW8DNu3DjuvfdeNm7cSPPmzR2ON3PmTKZOncpHH31E+/bt+eCDD6r5ruLpp59m2rRpGAwGRo0aRWRkZMM/pPjrSkYtmu6lmqqpFuuIiYkhIyPD02EAcOjQIbp06eLpMBgwYAA7d+70dBguxWIoRF18BIACEUqL0OhG+6zPqtrVf+tevXrZTTZuussWkhsSi9k6y1w2B3LB1MLD0ThGCuca4nqfbeAv4QiVBqNZ1GvRw51I4UiaFKJyCVqrhgC1HrOp3MMR2afJbmST3KBUCsefItp5X8ZQAWidzyFzF3LGkTQpKlQB5JmCMXtZl9uFuWkuSUvhXIOcO3fO9tTeHh988IFb4qhK87kSvV5P//79uf/++xvkU08QZ43hqH0ql8mb6LMcKRwlOZEC66PhY7X13xMpLhkmIiKCOXPmOHzfXcKxR0ZGBrGxsXz++ee12glh/8bfbBZ4aVSoNdbNj6p6PsuxWCz1sm8oUjhKcSIFfkmC0pOAsP77S1K9xJOens6oUaMYPnw4gwcPpqCgAID//u//ZuDAgdxzzz0UFhaSnZ3NlClTAOjbty+PP/44PXr0IDU1tUYi5rRp0xg0aBDx8fHVvlTp6enMnTsXsG4VWL16NUePHqVfv37Ex8fz0ksvAdbcttjYWGJjY/n1118BmDdvHrGxsbzxxhs1PsPs2bP55JNPmDt3rsPkzwcffJChQ4dWqx6zatUq4uLiGDm4L/t2pKJSe5P4+AL+56mFDBw4kHnz5tnOT0xMZMiQIUyfPt0W/4QJExg5ciT79+8nOTmZ/v37M3jwYE6dOkVOTg5Dhw7FbDbzzDPPsH79eqf/Jo6QwlGKjDlgLq1+zFxqPV4PysvL+f7773n44YdZvnw5e/bsQa/Xs337diZOnMi7775bzT4/P5958+bx7bff8t5771VL8oyLi+PMmTO2fT615ZuBVUxJSUls3bqVZ555hry8PDZu3Mj27dvZsGEDzz//PGfPnuWXX35hx44d3HnnnTV8LFq0iISEBBYtWmRL/ty1axdpaWm2fS6dOnVi8+bNhIWF2c6bMGEC6VvT2P7VEj5c9gaorYmeA3p3Y/u2dH799VdycqzbDTp27MiWLVvw8fFh9+7dADRr1oxvv/2WiIgI0tLS2LVrF88//zwvv/wykZGR3HfffSQlJXHy5EnGjh1br7+JPaRwlKL0VP2OO+C2224DoEePHhw9erRaAmWvXr04evRoNfuwsDDCw8OrJYNWodVqmTZtGlOmTGHu3LnVZhx7eWTjx49n//79TJ48mdTUVI4fP05GRgbx8fGMGzeOy5cvc/LkSbp37w5Az549a/0sjpI/7Z23adMm4uLiGT35CU7nXACVCgtqbuveGSxGunXrZjv/6t/RlT6zs7Nt8V35+5oyZQqff/65LY+usUjhKIX/TfU77oCqNKOMjAzat29vS6AE2Lt3L+3bt69mb08AVcfMZjOTJk1i7dq1XLx40baHB/5K9IS/EkS1Wi1vvPEGq1atYt68ebRr14477riD9PR00tPT+eGHH4iKirLZ//bbb7V+litj/+2334iOjgbsZ1q//PLLfP/NOjasfR1V5fsGVSDf/laIUHuTmZlpO//q39GVPqOjo23vX/n7WrBgAS+88ILtErSxyOc4ShHzovWe5srLNY2/9Xg90Gq1DBs2jPLyctatW0dISAhr1qwhNjaWwMBAPv744xozy9VcmYg5Z84czGYzQUFBdOvWzWbTvXt3cnNzGTFihG2/1MaNG3n77bcpLS1lypQphIWFMXLkSAYOHIhGo2Hw4ME899xz9OzZk9jYWGJiYmqNoz7Jn/fccw8D4++md0x7goOtS9EqlZpfdv9E7CcfEhc3iDZtrLtBDx06xF133UXbtm3p27cvf/zxh81PREQE8fHx9OvXD29vb9asWcO+ffvIzc0lOTkZs9nMihUrGDVqFO+//36tiyy1Ipoo3bt393QINg4ePOic4fG1QnwVJUSKyvrv8bX1Gmfr1q1izpw59Y7vesFYekGIvD2i/NIRIYQQD0xJEF9v3ydKyo02m/nz54sffvihXn4rKiqctr36b92zZ0+7dnLGUZJ2k63/SRpEVZ4aKuvXUoOJNt7nUVecBZ+2HoysJlI4TYi4uDji4uI8HYbHEBbrXhyVxrqitmrlUjQlx6i44vLX0b4wdyMXByRNhlJNOIfLoxDeoQBoNNY9NE1xQ5sUjqTJYLKAQWjx8qpsyaGWwpFI6sRkEahUKtRVS+wqLyyo0GAGi9mzwV2FFE4TIj09naioKOLi4hgzZoytEMfVrF692vZ85HoiyHSaKO9zqESlSFQqzFTOPk0s2VMKp4mRkJBAeno6/fr144svvrBrk5iYWOdTe0/TkGRLP4oJUhcDVzzUVVXVWLsGhVNQUMC9996LTqcjKiqKjz/+2K6dEIK5c+cSGRlJcHAwcXFx1coPSZynR48enDlzxmGi5JYtW/jpp5/o06cPgwcP5oMPPrCbpHl1wiPYrxJaRWpqKoMGDaJXr158+OGHtvHsJVaOHz+eoUOHMmbMGAwGA+np6YwePZpRo0axadMm1q5dy5133kn//v3JyMigpKSE+Ph4SkpKePfdd3nrrbf+GliYUSOwoALVX19LkyaIfFMQJqFsferG4tRy9GOPPYa3tzfnz5/n999/Z+TIkcTExNC1a/UaY59//jkffPABO3fuJCoqirlz55KQkGDLqr1u+LiWumW934MOlXWbjy6HXx6uafNA3fvot2/fTq9evRxWyQT47rvvSE5OJi4uDiEE77//PklJSSQmJiKE4Ny5c7aEx507d/Lyyy+zbNkyu1VCqxg4cCDDhg3DZDIRFxfH1KlTAWti5erVq5k1a5YtsTI4OJjPPvuM5ORkvvzySyIiIjAYDKSmpmI2m+nbty+7du0iJyeHxx9/nG+++YZnn32WmTNnUlBQUL2OdeVStAWvv+5xAItPODnFem4Wvri+erfz1Dnj6PV61q1bxwsvvEBAQAADBgxg9OjRfPTRRzVsT5w4wYABA7j55pvRaDRMmTKFgwcPuiTw65WPPvqI+Ph4Ll++zOjRox0mSgI8+uijfPbZZyQkJLBnz54aSZqOEh7tVQmtYt++fQwZMoS77rqr2tWCvcRKe8eqYr148SJRUVFotVqio6NtlTyHDBnCvn37SExMrJ6zViUcVfX/l2s1Vhuj2T37bJylzhnnzz//RKPR0KlTJ9uxmJgYtm3bVsN24sSJfPrpp/z555+0a9eONWvWMGzYMGUjbgo4MWMA1pmng+OODPaoSsmvwlGVTIDmzZvzzjvvkJuby0MPPcSXX37JG2+8gcFgoH///nz99dd2Ex5rq7D5yiuvsHLlSiIjI+nYsaPteEZGBiNGjCAjI4OEhAT++OOPWpMtw8LCyM7Oxmg0kpOTY+tc8e6775KQkMCKFSsYN26crVufxWJEjbW6zZVoNeCrNiBMFqDplIuqUzhXt+4A6xRdXFxcw7ZVq1bExsbSuXNnNBoNbdu2JS0tza5f2R+nJkajscZY//rXv5gxYwYGg4GRI0cSFhaG2WzGaDSydOlSNmzYQElJCU899RRffvkly5Yto7S0lEmTJtGiRQsGDhxI37598fb2ZuXKlRgMBoQQGAwGDAYDFoul2nijRo1i9OjRxMTE0KxZMwwGA2azmaysLOLj42nbti09e/YkKyuLixcvMmTIEHx9ffnkk0/YvXt3tfgfeeQRBgwYgFqtZsmSJRw7doz169ezYcMGOnfuzPz583n++ef55z//yZuvzMMHEGiqxaOylNPJ5xRGkzcGQ0CDfq+u6I9TZ5Lnr7/+Kvz8/Kode+2118Q999xTw/bZZ58Vffv2FadPnxZGo1GsWrVKREdHC71e72SK3V9ck0me1yn2EitXrVolVqxYodgY5fp8cfn8QVFWlFv9DbNRiLw9wpy3TwiLpUG+XZHkWec9TqdOnTCZTBw5csR2LCMjo8bCQNXxCRMm0KZNG7y8vEhMTOTSpUvyPkdSJxWqQE4aWmHxDqv+hkqDBTVqLCCazkPQOi/VdDod48aNY968eaxcuZLff/+dDRs28NNPP9WwveOOO/j888+ZOHEiYWFhpKSkYDQa6dChg0uCl7gHe4mVSrdvMVms91pemqtWLCsfgqqpsD4EVTeNvGSnonjnnXeYPn064eHhhISEsGzZMrp27cqpU6eqtfl4+umnuXDhAj169ECv19OhQwfWrVvndEMhyY2LMJejVZnQqGsu9VvUWrBUYDEbUHv5eyC6mjglnBYtWtitDHLTTTdVa/Ph6+vL0qVLWbp0qXIRNhHKyspku3YXEmg6RYhvOcLsB2pd9TdV1ic4ZlMFah/XjC8q27U7S9OY95o4rVq1IicnB6Ox6WXpXi9Y9GdRYwa/4zUux0zll/AyF2HSVODlW1Bv32az2anO2FqtllatWjnlUwrHCZo1ayYvN12JEBg+7oG3ygDjS8Cr+oyTk3uMqe/tZ9aIeO67rXO93efm5irewVwmeUo8j6kYb5WBcuFXQzQAYeHtOG5oy+mipnOZLIUj8TzlFwHQq+y3VfT2UhMW4MPZwjJ3RlUr8lJN4nFE+XlUQIUmxL6BxczLrd8grKwAxP9BE1igkcKReJzykvP4AUavUPsGag13eu9CpyqCiovgG+7W+OyG5OkAJJI8v97cf3QxRyOedGhTrIkAQOjrV1LYVUjhSDzORYM/e0pvRR1yh0Mbg7e1CmjppWw3RVU7UjgSj1NQYs1cDglwvFVN+FsLEhZfOuHQxp1I4Ug8TrPcD5jTaiXhliMObbwCrcXrKwqz3RRV7UjhSDxOeOF3zAxbT3Nx3qGNrlk7AIT+tLvCqhUpHInH8TZaO7P5BDpOdwls2Y304l5ki1vcFVatyOVoicfxtVTmn/mEObTRhN7BnEvJ9GnWgjj3hFUrcsaReBYhCBB1CwegVbAvuU0ke0AKR+JZjIV4qUyUCR14+dVqenOwET99FphKa7VzB/JSTeJZKvPUSlXNqV028C/NY7RqmYWl4G+ow/u5PrZakDOOxKMIi4H9ZR3J09Z901/1ELSkCTzLkcKReJRi306MPvImOyLeq9tYZ30IKoUjueHJr8waaKGru8CtT1AUAIaiky6NyRmkcCQe5VJxISoshATUXUxA1zza+qLU8w9BpXAkHiXkyDyOdhtLx8KatcivRhdsvVTzMuS5Oqw6UbTNB8Dx48e55557CAwMJDQ0lNmzZysWrOQ640QKkfkfo1FZaJn9IpxIqdVcnf8LAJGmfbA+uk57V6Jomw+DwcDf//53HnvsMT799FM0Gg1//vmnSwKXXOOcSIFfkvAS1geaGmMB/FJZoN5ey/sTKXBgAVDZdqr0ZO32LkbRNh+rV6+mdevWPPHEE+h0Onx9fW1tJiSSamTMAfNVDzLNpdbjjuwtZc7bu5g6heOozYe9Tmu7d+8mOjqa4cOHExoaSlxcHAcOHFA2Ysn1QamDnZxKHXcxirb5OHPmDFu3bmXjxo3cddddLFmyhDFjxnD48GG8vasvN15LbT4kyhPu0xqvipwax00+rblg5+9eX/srKSiofxHDuqhTOAEBARQVFVU7VlRURGBgYA1bPz8/BgwYwPDhwwF46qmnWLRoEYcOHSImJqaabVJSEklJjpsuxcTEKF5ETtKEuD0Zfp5Z/fJL44/X7cn2/+63J1vvaa68vKvN/ircXpCwPm0+unfvLmsrS5yj3WTo9TaXTEEIAP8o6L3c8Y1+u8nQezkmlTWjzaxtUbu9i6lTOFe2+dDr9ezatYsNGzZUa+JaxZQpU9i9ezdbtmzBbDbz1ltvERoaSpcuXVwSvOTaxnLzg9xx+BNebXEIxmbXLYJ2k8kJeQCACzc96THRgJPPcd555x3KysoIDw9n0qRJ1dp8BAQE2NqAd+7cmbVr1/LII4/QvHlzNmzYwMaNG2vc30gkAEXlRkwW4VTWQBVeftaaakb9BVeF5Vwczhg52+YDYNy4cYwbN06Z6CTXNSU5O3kodD0d1RagnVPn+ARY66tZyhzXJ3AHMuVG4jnObua51iuJrkh3+hT/IGtdAlXFRRcF5RxSOBKPYa6cNbx1LZ0+xy84moNlN3NBeHbFVe4AlXiOyt2fvoERTp+iCr2D6eeXMzA4FMd1P12PnHEkHkNTmeWsC3KuC1oVIQHetn08nkIKR+IxvE1W4Wh1zs84AC10WspL88Diufbt8lJN4jH8nCwLdTVL/O6lhd85KDsJuptcEFndyBlH4hmEBYPFC6PwAh8HfXEcYFBX9mMt99yzHCkciWdQqXng4hc8bvmpRpfpujBqrZ3bKkrOuSIyp5DCkXiMfH0FLXS+9T7P4m3NHtAXeS57XgpH4hFMZgv5egPhgc6n29iobGVYXuK57AEpHIlH0P/5Ef93y1SGGP9fvc/V+luFY9J7TjhyVU3iEUovn6KVtoByrane5/pWtgMxy8UByY2GUW/dzanV1e/hJ4Bv5GD+eepJ9vl4bluBnHEkHkGUngXAr7JWWn3wa9GJVP1dhBujFY7KeeSMI/EImgrr/UlAs8h6n6tSqQjR+ZBXUqF0WE4jZxyJR/AxWe9PvHVt6n+ysDAtZCPh5SXASmUDcxIpHIlH0FkuWisL+tUvT82Kimn+7+KjqgDTEvDSKR1enchLNYn7EYLPyqfxjfEB8G5R//NVKvSqyvM8tLImhSNxPyoVK/PG8aPv/0IDqyJVaKxpN8JDW6ilcCRuRwjBheKKhmUNVGLUWhNDyz2UryaFI3E7JXmHGarbSief7Ab7sHhbhaMvOqtMUPVE8TYfVQwePBiVSoXJVP8nw5Lrm/JT3/GfqFe53VD398gRaj9rnQJPZUgr2uajipSUFCkYiUPKi61ZzV7+DS+4odW1Is8UTKnBM7tAFW3zAVBYWMjChQt55ZVXFA9Wcn1gKbUKxyew/g8/bT5ueYJeB1P4NcBx/XFXomibD4Bnn32WWbNmERHRkPV5yY2Aqtx6eRXQrAEPPysJqWy2m+ehoh2KtvnYu3cvu3btYsmSJZw5c6ZWv7LNx42LplI4JRXeXG7E39hfq+bU+YI6vydNus2HxWLh0UcfZcmSJXh51X3rJNt83LgUYq1uE35TDOga+DcuO09ax0Q0Fh/CWtfdXKrJtvkoKipi7969TJgwgYiICO64w1ourk2bNuzYsUPRoCXXMMc/IkhUdo3ePKDhDXBzviPC6wKh4jR8FeX2Rrp1Tg1XtvlYuXIlv//+Oxs2bOCnn36qZhccHFxtyjx9+jS9e/dm3759hIXVr/yP5DrlRArseeSvZIGyUw1rgHsiBfY9DlQmHjTUTyNQrM2HSqUiIiLC9l+VWFq2bCnbfEis1Ldhrqv9NALF23xUER0djRCicdFJri+UaoDbBBrpypQbifvwd1B109FxV/tpBFI4EvcR8yIW1VUXORp/iHmx3n7Q+DfeTyOQwpG4j3aTydf1B3CuYW4tfui9HINXCBYBBm242xvpSuFI3IpeBABQdNtq5xrmOqLdZI4MOMbNB74hrUuG2xvpSuFI3IpXRVW6Tf2r21xNaGXT3Xy9+4t2SOFI3Iqf2brVWdOIzOgqmnvpGRa0i6D81Eb7qi+yWIfEregseZVFOupfiPBqvCtO8270y5wv6gg83Gh/9UEKR+I+LCZSy0cT5l1Ef21Q4/1VNqTytSifxFkXUjgS96H2YvH5mcR2DKV/A4t0VKNSOAHiMggLqNx35yHvcSRuw2IR5JVUENaIIh3V0HijF4FoVGYwXFLGp5NI4UjcRmH+cXr4ZhLlV6iYz1K1Z+qrSeFI3EbFiS/4osPT3Fm2TDGfhsr6apYyKRzJdYqhxLrtRNPQzWt2MFXWV9MXS+FIrlOqinT4BTW81sDVZEUtodOBrzgXNEwxn84ghSNxG+rKrAGdAlkDVTQLCsUgtOTr3Vu0QwpH4ja8jdbLKd9GlIW6mpCqtBs3V7uRwpG4DZ3lovWFAlkDVYSX7+GL9v/LzaeeVcynM8gHoBL3YDGiE5exoEbtE66Y2yBvC710hzhdFli3sYJI4Ujcg8qLCec/5fYIE8+oNYq51fhbC1/6mPIU8+kM8lJN4h5UKg4VBmEI7K6s38q0Gz8356tJ4UjcQqnBREmFifBAX2Ud+4RgESp0FILFfQXYFW3zsWbNGnr27ElQUBBt2rRh9uzZsmuBBIDio1/xXtQielq+Vdax2otSglCrBBjylfVd27DOGF3Z5iMlJYVZs2bZLbpeWlrKW2+9RV5eHj///DM//vgjr732muJBS649jPm/MTR4NxGcUNx3qdqaduPOfLU6Fweq2nxkZmbWaPOxePHiarazZs2yvY6MjGTy5Mls3bpV+agl1xwmfVVrD+XrgR/3G8F3p7KZovZ322qX4m0+rmT79u0Om09JbixUZdaWg/7ByqXbVHGk5ZMsyH2ESyrlHqzWhaJtPq5k1apV7N27l5UrV9p9X7b5uLFQlVuFU2bypVjhv6vKoAfg8IkzGEP9arzfpNt8XMn69ev597//zZYtWwgNDbVrI9t83FgUCOuNe3jb7qDw5VqXYj23+R9Gpwqhdes77do02TYfVaSmpjJz5ky+/vprunXrplykkmsXIQioau3hp3ynvrYlX/NVh6doceZtxX07ok7hXNnmQ6/Xs2vXLjZs2EBCQkIN27S0NCZPnsy6devo3bu3SwKWXINYDPxfRX8yLX3AS6e4e/8g62yiKr+ouG9HKNbmA+CFF16gsLCQESNGEBAQQEBAAMOHD3fpB5BcA2h8eDL3WVL8Hd/TNgb/QGvSqMbovrQbRdt8yKVniT1MZgv5+grClM4aqETtZ00a9TU3sQegEkljKLiUS6TXOSJ0LuqX5GsVjr9FCkdyHeH92xPs7DKDSdm3wPpo5ft15nyHEOCvKnFbP1ApHIlrOZFC0MWvAGvlW0pPWvt1KvXldtRX1MXikcKRuJaMOai5KtFXyX6dHuoHKoUjcS2u7tfpoX6gUjgS1+Lqfp0e6gcqhSNxLTEvUqP5uJL9Ou30A7WovF3eD1QKR5vIYQYAAAhISURBVOJabvoHKhV/iaehfT8dUdkPFP8oqoYo0HZxeWtDWaxD4lpUXiSdX8rtERYemfS4a8ZoNxnaTUalPw0bbiKg4g8wlYKXf93nNhA540hcilBp2JbfjoLgu1w/mK4tZzXd8FWVo89WeIv2VUjhSFxKUbmJCpOFcKV64tRF23sByDv8qUuHkcKRuJSS7O9Y2HoZXdnplvEiuj4AQGjhZjC7riyuFI7EpVgu7GRa6Le0sex3y3iq4M5cUHdApyqmLCfNZeNI4Uhch7CgPW9tpa5r3t5twxZ0eolxR18l7ZLrNlJK4UhcRsGB5USYMrlMGC261Nz46Co69riPk6oYUg+6rlyUFI7ENRgK8TpgzRcTPV4BbYDbhtaoVdzdtSVph85TbnBNQUwpHIlLyNnxb4JUBeRqe9G8yzS3j39/1CmWRz7N+e3/4xL/UjgSxTFWlOCb+zlmoSYk7l3+yvl3H90im9E/cD+BF76iZs5P45HCkSjOh3suEn94KVnRy/AJ6+mRGLQt+1FIKC04i6rogOL+pXAkilJ0eA3Dj91Jxt8m0e3ii27ZjWkXlRqjrgsAEb8NV3znqcxVkyjH0VX4/5pEkLbyhry0cjcmuDzpsgYnUggp+wW4auepQrEo2uYD4M033yQiIoLg4GCmT59ORUVFo4OUXBuY9v0TL1fu9qwPGXNQWa767ikYi6JtPjZt2sTixYv58ccfyc7O5vjx48yfP1+RQCVNG0vxSTSmIvtvung3Zn3GFKWnQFga7V4lRO1LDnq9nubNm5OZmWnrWJCQkEBkZGSNNh8PPPAA0dHRvPTSSwD8+OOPTJ48mXPnztU7sB63duL37Z/YfzO4G2i8ra+Lj4Kx0L6dNhgCO1hfmw1QWMtNYkB78G5mfV2aC5VFwmug0kLzK9rxXdoPwmjf1rcV+FfWLDZchpJjjsdvap/J4iDPy681Rp8IisqMlOZlocn9GlN5Adq8dFqZHKTV+EfB2GzHcbqC9dHWy7OryDGEUaYJwcevBV5thhNx22OofJo7dNOrVy/27t1b43id9ziO2nxs27athm1WVhZjxoypZnf+/Hny8/MJCQmpa6jqgZUegdRedt+LO7qWiyarv6Vt5hMX8Itdu/SS3jx2ZiEAYV75pHeY4nC8x87MJ73EWrD70dC1PBZq/0bygrEF8cf+em9r+8mEa+1Xw1+aN5l38qxjxgXsZmmbhQ7Hv1Y+09sXH+C1s9ZEyqFBP/Fe9Eu294zCCy+NFypL+V8nKLnbsz7EvGi9p7mikIdZ7Udms1kM0S9CY7BgPrabGfvv4P2kofV2X+eMs2PHDu6///5qs8aKFStISUkhPT29mm379u1ZunQpw4YNA8BoNOLt7c2JEyeIjo6uZltXm4/MzExuvfXWen4cicepKICyHOuMpfYGv0jwaXHNxpKdnU1eXs3Suoq2+bjatuq1Pdu62nw4miIlkvriiu+Som0+unbtSkZGRjW7li1b1vsyTSJp6ija5mPq1Km8//77HDx4kEuXLrFo0SISExNdEbdE4lEUbfMxbNgwZs+eTXx8PFFRUURFRbFwoeMbYonkWqXOxQFPIe9xJErhkXsciURSEykciaQBNFnh1LZULZHUB1d8l5rsPY5E0pRpsjOORNKUkcKRSBqAFI5E0gA8Jhy5OU7SUOLi4vD19SUgIICAgAA6d+5se6+0tJRHH32U0NBQgoODGThwoEM/hw4dYvDgwQQHB9OhQwe++uor54MQHmLixIli/Pjxori4WOzYsUMEBQWJzMzMGnapqakiPDxcZGZmioKCAjFo0CDx9NNPeyBiSVNh0KBBYsWKFXbfmzx5spgwYYK4cOGCMJlMYu/evXbtjEaj6Nixo3j99deFyWQSP/74o/D39xd//PGHUzF4RDglJSVCq9VWC3LKlCl2BTFp0iTxzDPP2H7esmWLaNmypVvilDRNHAnn8OHDIjAwUBQWFtbp48CBA0Kn0wmLxWI79ve//13MnTvXqRg8cqnmaHOcve3YWVlZxMTEVLOr2hwnuXF55plnCA0NpX///rZ9YT///DNRUVHMnz+f0NBQunXrxrp16+yeL+w8hRFCkJmZ6dT4HhFOSUkJwcHB1Y4FBwdTXFxcp23Va3u2khuD5ORkjh8/Tk5ODklJSYwaNYpjx45x5swZMjMzCQ4OJjc3l7fffptp06Zx6NChGj5uueUWwsPDefXVVzEajWzevJlt27ZRWlpqZ8SaeEQ4rtocJ7kx6NOnD4GBgfj4+DBt2jT69+/Pd999h5+fH1qtlrlz5+Lt7c2gQYOIj49n8+bNNXxotVrWr1/Pt99+S0REBK+//jrjx4+nTZs2TsXgEeHIzXESJVGpVAgh6N69e93GV9C9e3e2bdtGfn4+mzZt4vjx4/Tu3du5k528H1OcCRMmiIkTJ4qSkhKxc+dOh6tq33//vWjZsqXIysoSBQUFIj4+Xq6q3cBcunRJpKamirKyMmE0GsXatWuFv7+/OHz4sDAYDKJ9+/bi+eefF0ajUezcuVMEBASIQ4cO2fWVkZEhysrKhF6vF6+++qqIjo4W5eXlTsXhMeHk5+eLMWPGCH9/f9G2bVuRkpIihBDi5MmTQqfTiZMnT9psX3/9dREeHi4CAwNFYmKi0x9Ocv1x4cIF0atXLxEQECCCg4NFnz59xObNm23vZ2ZmijvvvFP4+/uLLl26iC+//NL23osvviiGDRtm+/mpp54SzZo1EzqdTgwbNkwcOXLE6ThkkqdE0gBkyo1E0gCkcCSSBiCFI5E0ACkciaQBSOFIJA1ACkciaQBSOBJJA5DCkUgagBSORNIA/j8kurFhF5A0sgAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">e</span><span class="o">=</span><span class="mi">10</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Poisson</span><span class="p">([</span><span class="mi">5</span><span class="o">*</span><span class="n">e</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">e</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">p</span><span class="o">.</span><span class="n">altpars</span><span class="p">(),</span> <span class="n">p</span><span class="o">.</span><span class="n">p</span><span class="p">)</span>

<span class="c1"># Derive parameters, assuming mu&lt;0</span>
<span class="kn">from</span> <span class="nn">scipy.misc</span> <span class="kn">import</span> <span class="n">derivative</span>
<span class="n">g</span><span class="p">,</span><span class="n">h</span> <span class="o">=</span> <span class="p">[</span><span class="n">derivative</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">,</span> <span class="mf">1e-4</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)]</span>

<span class="n">beta</span><span class="o">=-</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">g</span><span class="o">/</span><span class="n">e</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">h</span><span class="o">/</span><span class="n">e</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">mu</span> <span class="o">=</span> <span class="n">beta</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">g</span><span class="o">/</span><span class="n">e</span><span class="p">)</span>
<span class="n">pars</span> <span class="o">=</span> <span class="p">[(</span><span class="n">mu</span><span class="o">-</span><span class="n">beta</span><span class="p">)</span><span class="o">/</span><span class="n">e</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">beta</span><span class="o">/</span><span class="n">e</span><span class="p">]</span> 
<span class="n">pars</span><span class="p">,</span> <span class="p">(</span><span class="n">mu</span><span class="p">,</span><span class="n">beta</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Poisson: mu,beta= 510.0, 10.0 (10, 10.0, 510.0) [50, 10, 1.0]
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>([49.999904510304965, 10, 1.0001000868166177],
 (510.0000459712158, 10.001000868166177))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Check-high-statistics,-no-background">Check high statistics, no background<a class="anchor-link" href="#Check-high-statistics,-no-background"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">mu</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Poisson</span><span class="p">([</span><span class="n">mu</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span> <span class="sa">f</span><span class="s1">&#39;Input: mu = </span><span class="si">{</span><span class="n">mu</span><span class="si">:</span><span class="s1">-8.0f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Fit:   </span><span class="si">{</span><span class="n">PoissonFitter</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span><span class="o">.</span><span class="n">poiss</span><span class="si">}</span><span class="s1">&#39;</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Input: mu =      100	Fit:   Poisson: mu,beta= 100.0, 0.0
Input: mu =     1000	Fit:   Poisson: mu,beta= 1000.3, 0.1
Input: mu =    10000	Fit:   Poisson: mu,beta= 10021.4, 10.7
Input: mu =   100000	Fit:   Poisson: mu,beta= 114749.9, 7628.5
Input: mu =  1000000	Fit:   Poisson: mu,beta= 1030016.1, 15119.3
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">Poisson</span><span class="p">([</span><span class="mi">10000</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span> <span class="p">;</span> <span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="n">pf</span> <span class="o">=</span> <span class="n">PoissonFitter</span><span class="p">(</span><span class="n">p</span><span class="p">);</span> <span class="n">pf</span><span class="o">.</span><span class="n">poiss</span><span class="o">.</span><span class="n">p</span>

<span class="n">pf</span><span class="o">.</span><span class="n">poiss</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="n">pf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mf">1e5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Poisson: mu,beta= 10100.0, 100.0
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>([9999.997554752043, 0.9974355313909493, 74.10298197458243],
 [9999.997554752043, 0.9994459695779796, 94.40413079520135])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

