---

title: Exposure processing


keywords: fastai
sidebar: home_sidebar

summary: "Combine the FT2 spacecraft livetime information with the effective area to produce exposure for a given direction and spectrum "
description: "Combine the FT2 spacecraft livetime information with the effective area to produce exposure for a given direction and spectrum "
nb_path: "nbs/03_exposure.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/03_exposure.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The spacecraft information is a list, for 30-s intervals, of the livetime and instrument $\theta$ of the source. 
We need a weighted effective area
as a function of $\theta$. This requires a weighting function of energy, or a spectrum. Matthew used a simple power law with index -2.1. implemented in by the class <a href="/wtlikeexposure.html#KerrAeff"><code>KerrAeff</code></a>. But here we have the actual source spectrum available. Also, the data here excludes low-energy Back events the class <a href="/wtlikeexposure.html#SourceAeff"><code>SourceAeff</code></a> uses both.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Implemented-here:">Implemented here:<a class="anchor-link" href="#Implemented-here:"> </a></h2><ul>
<li><a href="/wtlikecell_data.html#time_bin_edges"><code>time_bin_edges</code></a></li>
<li><a href="/wtlikeexposure.html#cell_exposure"><code>cell_exposure</code></a></li>
<li><a href="/wtlikeload_data.html#sc_data_selection"><code>sc_data_selection</code></a></li>
<li><a href="/wtlikeexposure.html#binned_exposure"><code>binned_exposure</code></a></li>
</ul>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="time_bin_edges" class="doc_header"><code>time_bin_edges</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/exposure.py#L14" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>time_bin_edges</code>(<strong><code>config</code></strong>, <strong><code>exposure</code></strong>, <strong><code>tbin</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>Return an interleaved array of start/stop values</p>
<p>tbin: an array (a,b,d), default config.time_bins</p>
<p>interpretation of a, b:</p>

<pre><code>if &gt; 50000: interpret as MJD
if &lt; 0:     offset from stop
otherwise:  offset from start

</code></pre>
<p>d : if positive, the day bin size
    if 0; return contiguous bins</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cell_exposure" class="doc_header"><code>cell_exposure</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/exposure.py#L61" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cell_exposure</code>(<strong><code>config</code></strong>, <strong><code>exposure</code></strong>, <strong><code>time_bins</code></strong>, <strong><code>exposure_factor</code></strong>=<em><code>1e-06</code></em>, <strong><code>set_costh</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>Determine the exposure per cell
input:</p>
<ul>
<li>exposure -- dataframe with spacecraft data</li>
<li>time_bins -- time binning (start, stop, step) tuple</li>
</ul>
<p>Return: a dict of</p>
<ul>
<li>edges -- list of cell edges, an interleaved array of start/stop values</li>
<li>exp -- exposure per cell, in cm^2 Ms units, if exposure_factor==1e-6</li>
<li>etot -- total exposure</li>
<li>costh -- mean cos theta per cell if requested</li>
<li>exp_energy if exp_fract in the exposure DF, set exposure energy</li>
</ul>
<p>Note: total exposure vs. energy is:
    t = df.apply(lambda r: np.array(r.exp * np.array(r.exp_fract), float), axis=1).values
    u = np.vstack(t)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="cumsimpson" class="doc_header"><code>cumsimpson</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/exposure.py#L147" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>cumsimpson</code>(<strong><code>y</code></strong>, <strong><code>dx</code></strong>)</p>
</blockquote>
<p>Return the cumulative Simpson integral for an odd number&gt;2 of equally-spaced evaluations</p>
<ul>
<li>y -- array of integrand values, 2n+1 values for 2n intervals</li>
<li>dx -- interval size</li>
</ul>
<p>Returns array of size n, the cumulative integral estimate for pairs of intervals.</p>
<blockquote><blockquote><blockquote><p>x, dx = np.linspace(0,1, 5), 1/4
print(cumsimpson(x, dx))
[0.125 0.5  ]</p>
</blockquote>
</blockquote>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Demonstrate-superiority-of-integral-using-integrand-f(x)-x-dlog(x)">Demonstrate superiority of integral using integrand f(x) x dlog(x)<a class="anchor-link" href="#Demonstrate-superiority-of-integral-using-integrand-f(x)-x-dlog(x)"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nbins</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**-</span><span class="mi">2</span>
<span class="n">ee</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">nbins</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="mf">1e-2</span><span class="o">-</span><span class="mf">1e-4</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Errors:</span><span class="se">\n\t</span><span class="s1">Linear: </span><span class="si">{</span><span class="n">simpson</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="n">ee</span><span class="p">),</span> <span class="n">ee</span><span class="p">)</span><span class="o">/</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="si">:</span><span class="s1">+6.1e</span><span class="si">}</span><span class="s1">&#39;</span>
      <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">Log:    </span><span class="si">{</span><span class="n">simpson</span><span class="p">(</span> <span class="n">f</span><span class="p">(</span><span class="n">ee</span><span class="p">)</span><span class="o">*</span><span class="n">ee</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ee</span><span class="p">)</span> <span class="p">)</span><span class="o">/</span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="si">:</span><span class="s1">+6.1e</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Errors:
	Linear: -4.7e-03
	Log:    +3.8e-05
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="BaseAeff" class="doc_header"><code>class</code> <code>BaseAeff</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/exposure.py#L168" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>BaseAeff</code>(<strong><code>config</code></strong>, <strong><code>source</code></strong>, <strong><code>elim</code></strong>:<code>tuple</code>=<em><code>(100.0, 10000.0)</code></em>)</p>
</blockquote>
<p>Base class for calculating the weighted effective area</p>
<p>It defines a functor of <code>costh</code>, returning  the effective area weighted by a spectrum.
The exposure is then a sum over intervals of this weighted effective area times the livetime per interval.</p>
<p>A subclass must define a <code>setup</code> method to define the spectral function and minimum energy
to include Back events.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="KerrAeff" class="doc_header"><code>class</code> <code>KerrAeff</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/exposure.py#L216" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>KerrAeff</code>(<strong><code>config</code></strong>, <strong><code>source</code></strong>, <strong><code>elim</code></strong>:<code>tuple</code>=<em><code>(100.0, 10000.0)</code></em>) :: <a href="/wtlikeexposure.html#BaseAeff"><code>BaseAeff</code></a></p>
</blockquote>
<p>Kerr implementation from godot, which uses a $E^{-2.1}$ powerlaw spectrum</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="SourceAeff" class="doc_header"><code>class</code> <code>SourceAeff</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/exposure.py#L243" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>SourceAeff</code>(<strong><code>config</code></strong>, <strong><code>source</code></strong>, <strong><code>elim</code></strong>:<code>tuple</code>=<em><code>(100.0, 10000.0)</code></em>) :: <a href="/wtlikeexposure.html#BaseAeff"><code>BaseAeff</code></a></p>
</blockquote>
<p>BaseAeff subclass that uses the actual source spectrum applied only to used bands</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="WeightedAeff" class="doc_header"><code>class</code> <code>WeightedAeff</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/exposure.py#L254" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>WeightedAeff</code>(<strong><code>config</code></strong>, <strong><code>nebins</code></strong>:<code>int</code>=<em><code>16</code></em>, <strong><code>imin</code></strong>:<code>tuple</code>=<em><code>(0, 0)</code></em>, <strong><code>spectrum</code></strong>=<em><code>None</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Manage the weighted effective area calculation</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="NewSourceAeff" class="doc_header"><code>class</code> <code>NewSourceAeff</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/exposure.py#L301" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>NewSourceAeff</code>(<strong><code>config</code></strong>, <strong><code>source</code></strong>) :: <a href="/wtlikeexposure.html#WeightedAeff"><code>WeightedAeff</code></a></p>
</blockquote>
<p>Manage the weighted effective area calculation</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Weighted-exposure">Weighted exposure<a class="anchor-link" href="#Weighted-exposure"> </a></h2><p>The computation of the likelihood for a given cell needs a measurement of the exposure to determine the 
estimated number of source counts expected for the average source rate.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="weighted_aeff" class="doc_header"><code>weighted_aeff</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/exposure.py#L306" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>weighted_aeff</code>(<strong><code>config</code></strong>, <strong><code>source</code></strong>)</p>
</blockquote>
<p>Use config.use_kerr to return appropriate weighted effective area function of cos theta</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Compare-weighted-effective-area:-Kerr-mode-vs-actual-with-Geminga">Compare weighted effective area: Kerr-mode vs actual with Geminga<a class="anchor-link" href="#Compare-weighted-effective-area:-Kerr-mode-vs-actual-with-Geminga"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">wtlike.sources</span> <span class="kn">import</span> <span class="n">PointSource</span>
<span class="n">config</span><span class="o">=</span><span class="n">Config</span><span class="p">()</span>
<span class="c1"># source_name=&#39;LS 5039&#39; #&#39;Geminga&#39;</span>

<span class="k">def</span> <span class="nf">aeffplots</span><span class="p">(</span><span class="n">ke</span><span class="p">,</span><span class="n">se</span><span class="p">):</span>
    <span class="n">ct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">ke</span><span class="o">.</span><span class="n">edom</span><span class="p">,</span> <span class="n">ke</span><span class="o">.</span><span class="n">wts</span><span class="o">/</span><span class="n">ke</span><span class="o">.</span><span class="n">wts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;power law&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">se</span><span class="o">.</span><span class="n">edom</span><span class="p">,</span> <span class="n">se</span><span class="o">.</span><span class="n">wts</span><span class="o">/</span><span class="n">se</span><span class="o">.</span><span class="n">wts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">source_name</span><span class="si">}</span><span class="s1"> spectrum&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span><span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;energy dependence&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;relative weight&#39;</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">se</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span><span class="o">/</span><span class="n">se</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;power law&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ct</span><span class="p">,</span> <span class="n">ke</span><span class="p">(</span><span class="n">ct</span><span class="p">)</span><span class="o">/</span><span class="n">ke</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;.-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">source_name</span><span class="si">}</span><span class="s1"> spectrum&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;angular dependence&#39;</span><span class="p">,</span><span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">1.0</span><span class="p">),</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">),)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span> <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>

<span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
    <span class="n">source_name</span><span class="o">=</span><span class="s1">&#39;Geminga&#39;</span>
    <span class="n">source</span><span class="o">=</span><span class="n">PointSource</span><span class="p">(</span><span class="n">source_name</span><span class="p">)</span>

    <span class="n">ke</span> <span class="o">=</span> <span class="n">KerrAeff</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span> 
    <span class="n">se</span> <span class="o">=</span> <span class="n">SourceAeff</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
    <span class="n">aeffplots</span><span class="p">(</span><span class="n">ke</span><span class="p">,</span><span class="n">se</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">/tmp/ipykernel_232/2499459214.py</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">     23</span>     source<span class="ansi-blue-fg">=</span>PointSource<span class="ansi-blue-fg">(</span>source_name<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     24</span> 
<span class="ansi-green-fg">---&gt; 25</span><span class="ansi-red-fg">     </span>ke <span class="ansi-blue-fg">=</span> KerrAeff<span class="ansi-blue-fg">(</span>config<span class="ansi-blue-fg">,</span> source<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     26</span>     se <span class="ansi-blue-fg">=</span> SourceAeff<span class="ansi-blue-fg">(</span>config<span class="ansi-blue-fg">,</span> source<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     27</span>     aeffplots<span class="ansi-blue-fg">(</span>ke<span class="ansi-blue-fg">,</span>se<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;KerrAeff&#39; is not defined</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="sc_data_selection" class="doc_header"><code>sc_data_selection</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/exposure.py#L320" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>sc_data_selection</code>(<strong><code>config</code></strong>, <strong><code>source</code></strong>, <strong><code>sc_data</code></strong>)</p>
</blockquote>
<p>Return a DataFrame with the S/C data for the source direction, wtih cos theta and zenith cuts</p>
<p>columns:</p>
<ul>
<li>start, stop, livetime -- from the FT2 info</li>
<li>cos_theta -- angle between bore and direction</li>
<li>exp -- the exposure: effective area at angle weighted by a default spectral function, times livetime</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="binned_exposure" class="doc_header"><code>binned_exposure</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/exposure.py#L346" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>binned_exposure</code>(<strong><code>config</code></strong>, <strong><code>exposure</code></strong>, <strong><code>time_edges</code></strong>)</p>
</blockquote>
<p>Bin the exposure into cells</p>
<ul>
<li>exposure -- A DataFrame derived from FT2</li>
<li>time_bins: list of edges, an interleaved start/stop array</li>
</ul>
<p>Returns:</p>
<p>An array of exposure integrated over each time bin. Assumes that the time bins
are contained within the exposure.</p>
<p>it is interleaved, client must apply [0::2] selection.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

