---

title: Making FermiLAT gamma-ray light curves with wtlike 


keywords: fastai
sidebar: home_sidebar

summary: "Quickly create a light curve for any 4FGL source, on any time scale, with optional Bayesian Block analysis "
description: "Quickly create a light curve for any 4FGL source, on any time scale, with optional Bayesian Block analysis "
nb_path: "nbs/index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="github-links:">github links:<a class="anchor-link" href="#github-links:"> </a></h4><p><a href="https://tburnett.github.io/wtlike/">this document</a>,   <a href="https://github.com/tburnett/wtlike">the repository</a></p>
<h2 id="Introduction">Introduction<a class="anchor-link" href="#Introduction"> </a></h2><p><code>wtlike</code>(Perhaps pronounced "DUB-Tee-like"), is a library optimized for interactive exploration in a <a href="https://jupyter.org/">Jupyter notebook</a> with access to all Fermi-LAT data, and to analyze the time dependence of any source in the
4FGL catalog on any time scale, with the option of performing a <a href="https://arxiv.org/pdf/1207.5578.pdf">Bayesian Block</a>  partition to select optimal time intervals. The source can be identified by the 4FGL name, or any equivalent common name.</p>
<p>Here is a minimal demo:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">wtlike</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
<span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">Timer</span><span class="p">()</span> <span class="k">as</span> <span class="n">t</span><span class="p">:</span>
        <span class="n">wtl</span> <span class="o">=</span> <span class="n">WtLike</span><span class="p">(</span><span class="s1">&#39;3C 273&#39;</span><span class="p">,</span><span class="n">week_range</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="mi">52</span><span class="o">+</span><span class="mi">9</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>SourceData:  4FGL J1229.0+0202
LoadData: Loading weeks[9:165:]	Processing 157 week files, using 4 processes .............................................................................................................................................................

SourceData: Source 3C 273 with:
	 data:        33,210 photons from 2008-08-04 to 2011-08-03
	 exposure:   713,320 intervals,  average effective area 2785 cm^2 for 21.3 Ms
	 rates:  source 2.02e-07/s, background 3.57e-07/s,
CellData: Bin photon data into 156 1-week bins from 54683.0 to 55775.0
LightCurve: select 156 cells for fitting with e&gt;35 &amp; n&gt;2
elapsed time: 37.3s (0.6 min)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This created a <a href="/wtlikemain.html#WtLike"><code>WtLike</code></a> object, loading the first 3 years of data, by specifying weeks from #9, the first data-taking week.
The reason to specify only the first three years here is to avoid the 10 min or so that extracting the furl 13+ years would take for this demo. If that had already been done, then using an included <a href="https://tburnett.github.io/wtlike/config.html#Cache">cache system</a>, it only has to be done once.</p>
<p>Now ask it to make a plot:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
    <span class="n">wtl</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">UTC</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAs0AAAEGCAYAAACeiKhrAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjMuNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8QVMy6AAAACXBIWXMAAAsTAAALEwEAmpwYAAA2KklEQVR4nO3deXgUVb7/8U+HkLAEBEQcIEBEFmNYIgRIGAGFCThchSvguKBEFHMd5bqhg/fnPCrICCh6RUfGGy86gEpwwIFxeVABFYchYlRU4AoZsREQULMISUhCkv79kUnb6XR39Vq95P16Hh/p6krV6e46Vd8651vnWGw2m00AAAAA3IoLdwEAAACASEfQDAAAABggaAYAAAAMEDQDAAAABgiaAQAAAAPx4S6AN7p27aqUlJRwFwMBqKmpUUJCQriLAUQF6gvgHeoKQsFqterHH39stjwqguaUlBQVFhaGuxgIgNVq5cYH8BL1BfAOdQWhkJGR4XI56RkAAACAAYJmAAAAwABBMwAAAGCAoBkAAAAwQNAMAAAAGCBoBgAAAAwQNAMAAAAGWlTQfMuKEt2yoiTcxQAAAECUaVFBc7DddNNN6tatmwYNGmTqfi+55BLDyV5SUlJczmbz3HPPafXq1aEqGhAy3PQCAMKpxQTNBQeq7f+ev7qsyWt/3Xjjjdq8eXPA2zHTrbfeqlmzZoW7GAAAAFGlRQTNBQeqteb9CvvrkvJ6rXm/IuDAeezYserSpYvHdR577DE9/fTTkqS7775b48ePlyRt3bpV119/vSTpnXfeUVZWloYNG6arrrpK5eXlkqRPPvlE48aN0/DhwzVp0iQdO3asybbr6+uVk5Oj3//+9y73/fjjj2vkyJEaOXKk/vnPf0qSHn74YS1btkxSQ4v1/PnzNXLkSA0YMEAffvihJGnv3r0aOXKk0tPTNWTIEBUVFfnz9QAAAEiSqqqqNHLkSA0dOlRpaWl66KGHmry/bNkyXXDBBRo0aJCGDh3qslf8vvvu0wUXXKAhQ4boyiuvVFlZmSTp5ZdfVnp6uv2/uLg47d69W5J02WWX2fd56623qq6uzu/PENNBc2N37sotFaqpbfpeTa20cktFyLt7x44daw9GCwsLVV5erjNnzujvf/+7xowZox9//FGLFi3Sli1b9OmnnyojI0NPPvmkzpw5o//8z//U+vXr9cknn+imm27SAw88YN9ubW2tZs6cqQEDBmjRokUu992xY0ft2rVLc+fO1V133eVyndraWu3atUtPPfWUFixYIKkhhePOO+/U7t27VVhYqOTk5OB+KQAAoEVJTEzUtm3b9Pnnn2v37t3avHmzCgoKJDXEHe+++6527dqlPXv2aPv27bLZbM22kZ2drT179uiLL77QgAEDtHjxYknSzJkztXv3bu3evVtr1qxRSkqK0tPTJUmvvvqqPv/8c+3Zs0c//PCD/vKXv/j9GUIWNLvK93V3hxDLhg8frk8++USnTp1SYmKisrKyVFhYqA8//FBjxoxRQUGB9u3bp1/+8pdKT0/XqlWrdOjQIe3fv1979uxRdna20tPTtWjRIh05csS+3f/4j//QoEGDmgTSzq699lr7/3fu3OlynWnTptnLabVaJUlZWVl69NFHtXTpUh06dEht27YN0rcB+CcU6VUAAPNYLBYlJSVJks6cOaMzZ87IYrFIkh599FGtWLFCHTt2lCSdddZZysnJabaNiRMnKj4+XpKUmZnZJC5qtHbtWnv8I8m+zdraWtXU1Nj36Y+QBc2u8n3d3SGEyvO3ddHzt3VRlyTXH7NLUpyev81zeoWvDh8+bO8eeO6559S6dWulpKToxRdf1OjRozVmzBi99957+vrrr5Wamiqbzabs7Gz7HdK+ffu0cuVK2Ww2paWl2Zd/+eWXeuedd+z7GT16tN577z1VVVW5LYvjgeHuIElMTJQktWrVSrW1Dc3x1113nf72t7+pbdu2mjRpkrZt2xaMrwbwS6jSqwAA5qqrq1N6erq6deum7OxsjRo1SqdOndKpU6d0/vnn+7StF154Qb/+9a+bLV+3bl2ToFmSJk2apG7duqlDhw6aMWOG3+UPWdDsKt/XmzuEULgys60S4psuS4hvWB5svXr1sge6t956q6SG72LZsmUaO3asxowZo+eee07p6emyWCzKzMzUjh077DnHlZWVOnDggAYOHKgffvjB3kJ85swZ7d27176fm2++WZMnT9ZVV11lD3adrVu3zv7/rKwsrz/DwYMH1bdvX91xxx2aMmWKvvjiC7++CyAY/lpw2mV61V8LToenQAAAv7Rq1Uq7d+/WkSNH7KkYNpvN59bfP/zhD4qPj9fMmTObLP/oo4/Url27ZqOavf322zp27Jiqq6sDagiMN14lNF544QVdffXVbt/Py8tTXl6eJOn48eP21AF//CJB+nVavDZ93k6S1LFNvS4dWKVfJJxUAJvVHXfcoYKCApWWlqp79+666667XH6m/v3769ixY+rRo4dOnz6tVq1aKS0tzf6ZlixZounTp6u6uqHlbN68eUpISNDTTz+tO++8U6dOnVJdXZ1mz56t9u3bq6qqSt99952mTZumQ4cOadq0aXrqqacUF/fzPVBtba1OnDih9PR02Ww2LV++XFarVWVlZaqpqZHVarVvx2q1qqSkRLW1tbJarXruuee0ceNGxcfH65xzztGNN94Y0PcvScXFxQH9PVqupPoKJbVz8Ua9ZLWWmV0cU1BfAO9QV6JXenq6XnnlFeXm5qpNmzbavn27evfubfh3GzZs0IYNG/Tyyy/r0KFDTd7Ly8vTZZdd5jZmGT16tNasWaP+/fv7VWaLzVWmdZBYrVZdfvnl2rNnT5Plf/jDH1RYWKjXXnvNq7uLjIwMw3GJvdH40F+wUzJgzGq1KiUlJdzFQBSav7pMJeX1zZZ3SYrT0lmdzC+QCagvgHeoK9Hjhx9+UOvWrdWpUyedPn1aEydO1Pz583X55ZdrxYoVev3117Vu3Tp17NhRJ0+eVH5+vnJzc5tsY/Pmzbrnnnv0wQcf6JxzzmnyXn19vXr37q3t27erb9++kqTy8nKdOnVK3bt3tw+gMGbMGM2dO9djWd3Fnaa3NK9atUpvvPGGtm7dGlAytj8IloHoc2VmW615v+kIOKFKrwIAhMaxY8eUk5Ojuro61dfX6ze/+Y0uv/xySdJvf/tblZeXa8SIEWrdurVat26tefPmNdvG3LlzVV1drezsbEkNqb7PPfecJGn79u1KTk62B8ySVFFRoSlTpqi6ulp1dXUaP368PXXWH6a2NHu6Q/AkWC3NCB9aAxCIggPVWrml4WHALklxujKzrTIHJIa5VKFDfQG8Q11BKLiLO0P2IOC1116rrKws7d+/X8nJyVq5cqXmzp2rU6dO2YdRCyTaB9ByOAbIS2d1iumAGQAQmUKWnrF27dpmy26++eZQ7Q4AAAAImbCNngEAvuCZBABAOMX0NNrOKl6erYqXZ4e7GAAAAIgyLSpoNsu2bds0bNgwDRo0SDk5OfbJR95//32dddZZ9hkDFy5cKKlhGJaLL75YgwYN0saNG+3bmTp1qr777juX+3j44Ye1bNkySdKDDz6oLVu2eF2+7777zj4jzu7du/XWW2/58zEBAABaDILmIKuvr1dOTo7y8/O1Z88e9enTR6tWrbK/P2bMGPuMgQ8++KCkhvzvnJwc7dy5U48//rgk6fXXX9ewYcPUo0cPw30uXLhQv/rVr7wuY48ePbR+/XpJBM0AAADeIGgOsuLiYiUmJmrAgAGSpOzsbG3YsMHj37Ru3VqnT59WdXW14uLiVFtbq6eeekr33XefV/u88cYb7UFwSkqK/t//+3/KyspSRkaGPv30U02aNEnnn3++fSxDq9WqQYMGqaamRg8++KDWrVun9PR0+7TbAAAAaCqmHwR0l7/svLz9zBeDts+uXbvqzJkzKiwsVEZGhtavX6/Dhw/b39+5c6eGDh2qHj16aNmyZUpLS9N1112n6667TqtXr9bSpUu1YsUKzZo1S+3auZo72FivXr20c+dO3X333brxxhu1Y8cOVVVVKS0trckwfwkJCVq4cKEKCwv1xz/+MeDPDgAAEKtiOmgOB4vFovz8fN19992qrq7WxIkTFR/f8DUPGzZMhw4dUlJSkt566y39+7//u4qKinTWWWfpzTfflCSVlpZq6dKleu2113TLLbeotLRU8+bNU1ZWltdlmDJliiRp8ODBKi8vV4cOHdShQwe1adNGZWVlQf/MAAAAsS6mg2bnFuTGFuZgtiy7kpWVpQ8//FCS9M477+jAgQOSpI4dO9rXmTx5sm677Tb9+OOP6tq1q335woUL9cADD2jt2rUaPny4rrvuOk2dOlXvvfee1/tPTGyY+CEuLs7+78bXjQ8lAgAAwHvkNIfA999/L0mqrq7W0qVL7SkRx48fV+Os5bt27VJ9fb3OPvts+98VFRXpu+++07hx41RZWam4uDhZLBZVVVWFrKwdOnTQqVOnQrZ9AACAWEDQHAKPP/64UlNTNWTIEF1xxRUaP368JGn9+vUaNGiQhg4dqjvuuEP5+fmyWCz2v3vggQe0aNEiSQ3TkP/5z39WZmam7r333pCV9dJLL9W+fft4EBAAAMADi62x6TOCZWRkqLCwMODtmJWegeasVqtSUlLCXQwgKlBfAO9QVxAK7uLOmM5pdkawDAAAAH+QngEAAAAYIGgGAAAADBA0AwAAAAYImgEAAAADBM0AAACAAYJmAAAAwABBMwAAAGCAoBkAAAAwQNAMAAAAGCBoBgAAAAwQNAMAAAAGQhY033TTTerWrZsGDRpkX1ZSUqLs7Gz1799f2dnZKi0tDdXuAQAAgKAJWdB84403avPmzU2WLVmyRBMmTFBRUZEmTJigJUuWhGr3AAAAQNCELGgeO3asunTp0mTZpk2blJOTI0nKycnRxo0bQ7V7AAAAIGjizdzZiRMn1L17d0lS9+7d9f3337tdNy8vT3l5eZKk48ePy2q1mlFEhEhxcXG4iwBEDeoL4B3qCsxkatDsi9zcXOXm5kqSMjIylJKSEt4CIWD8hoD3qC+Ad6grMIupo2ece+65OnbsmCTp2LFj6tatm5m7BwAAAPxiatA8ZcoUrVq1SpK0atUqTZ061czdAwAAAH4JWdB87bXXKisrS/v371dycrJWrlyp+++/X++++6769++vd999V/fff3+odg8AAAAETchymteuXety+datW0O1SwAAACAkmBEQAAAAMEDQDAAAABggaAYAAAAMEDQDAAAABgiaAQAAAAMEzQAAAIABgmYAAADAAEEzAAAAYICgGQAAADBA0AwAAAAYIGgGAAAADBA0AwAAAAYImgEAAAADBM0AAACAAYJmAAAAwABBMwAAAGCAoBkAAAAwQNAMAAAAGCBoBgAAAAwQNAMAAAAGCJoBAAAAAwTNAAAAgAGCZgAAAMBAWILm//7v/1ZaWpoGDRqka6+9VlVVVeEoBgAAAOAV04Pmo0eP6umnn1ZhYaH27Nmjuro65efnm10MAAAAwGuGQfPKlSubvK6rq9OCBQsC2mltba1Onz6t2tpaVVZWqkePHgFtDwAAAAileKMVtm7dqg0bNmjlypUqLi7W7NmzNW7cOL932LNnT917773q3bu32rZtq4kTJ2rixInN1svLy1NeXp4k6fjx47JarX7vE+FXXFwc7iIgxqx5v0KSdMMl7cNckuCjvgDeoa7ATIZB8yuvvKJ169Zp8ODBateundauXatf/vKXfu+wtLRUmzZt0jfffKNOnTrpqquu0ksvvaTrr7++yXq5ubnKzc2VJGVkZCglJcXvfSIy8BsimL6tLJEkpaR0CXNJQoP6AniHugKzGKZnFBUVafny5Zo+fbpSUlK0Zs0aVVZW+r3DLVu26LzzztM555yj1q1ba9q0afrHP/7h9/YAAACAUDMMmq+44gotXLhQ//M//6MPPvhA/fv314gRI/zeYe/evVVQ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V3Z2tkpLS+1/s3jxYvXr108DBw7U22+/bV++bt06DRkyRGlpafrd735n+mcBQs3X+lJcXKxLL71USUlJmjt3bpNtffLJJxo8eLD69eunO+64Q2TYIZYEs6488MAD6tWrl5KSkkz/HIhNBM3wS3x8vJ544gn93//9nwoKCvTss89q3759WrJkiSZMmKCioiJNmDBBS5YskSTt27dP+fn52rt3rzZv3qzbbrtNdXV1Ki4u1n333aetW7dq7969OnHihLZu3RrmTwcEl6/1pU2bNnrkkUe0bNmyZtv67W9/q7y8PBUVFamoqEibN282++MAIRPMunLFFVdo165dZn8ExDCCZvile/fuGjZsmCSpQ4cOSk1N1dGjR7Vp0ybl5ORIknJycrRx40ZJ0qZNm3TNNdcoMTFR5513nvr166ddu3bp4MGDGjBggH1Gp1/96lfasGFDWD4TECq+1pf27dvr4osvVps2bZps59ixYzp58qSysrJksVg0a9Ys+98AsSBYdUWSMjMz1b17d9PKjthH0IyAWa1WffbZZxo1apROnDhhP0l1795d33//vSTp6NGj6tWrl/1vkpOTdfToUfXr109fffWVrFaramtrtXHjRh0+fDgsnwMwgzf1xZ2jR48qOTnZ/rqxHgGxKJC6AoRCfLgLgOhWXl6u6dOn66mnnlLHjh3drucq79Jisahz587605/+pKuvvlpxcXEaPXq0Dh48GMoiA2HjbX1xx109AmJNoHUFCAVamuG3M2fOaPr06Zo5c6amTZsmSTr33HN17NgxSQ1dyd26dZPU0CLm2IJ85MgR9ejRQ1JD3tlHH32knTt3auDAgerfv7/JnwQIPV/qizvJyck6cuSI/bVjPQJiRTDqChAKBM3wi81m080336zU1FTdc8899uVTpkzRqlWrJEmrVq3S1KlT7cvz8/NVXV2tb775RkVFRRo5cqQk2bvZSktLtWLFCs2ZM8fkTwOElq/1xZ3u3burQ4cOKigokM1m0+rVqw3/BogmwaorQEjYAD98+OGHNkm2wYMH24YOHWobOnSo7c0337T9+OOPtvHjx9v69etnGz9+vK24uNj+N4sWLbL17dvXNmDAANtbb71lX37NNdfYUlNTbampqba1a9eG4+MAIeVPfenTp4+tc+fOtvbt29t69uxp27t3r81ms9k+/vhjW1pamq1v376222+/3VZfXx+ujwUEXTDryn333Wfr2bOnzWKx2Hr27Gl76KGHwvSpECuYRhsAAAAwQHoGAAAAYICgGQAAADBA0AwAAAAYIGgGAAAADBA0AwAAAAYImgEgClmtVg0aNKjJsocffljt27dXenq6LrzwQrVt21bp6elKT0/X+vXrtWvXLo0dO1YDBw7UBRdcoDlz5qiysjJMnwAAogvTaANADFmwYIHuvfdeWa1WXX755dq9e7ck6cSJExo5cqTy8/OVlZUlm82mDRs26NSpU2rXrl14Cw0AUYCgGQBagGeffVY5OTnKysqSJFksFs2YMSPMpQKA6EF6BgC0AHv27NHw4cPDXQwAiFoEzQAQhSwWi0/LAQCBIWgGgCh09tlnq7S0tMmykpISde3a1eX6aWlp+uSTT8woGgDEJIJmAIhCSUlJ6t69u7Zu3SqpIWDevHmzLr74Ypfrz507V6tWrdJHH31kX/bSSy/p+PHjppQXAKIdDwICQJRavXq1br/9ds2bN0+S9NBDD+n88893ue65556r/Px83Xvvvfr+++8VFxensWPHatq0aWYWGQCilsVms9nCXQgAAAAgkpGeAQAAABggaAYAAAAMEDQDAAAABgiaAQAAAAMEzQAAAIABgmYAAADAAEEzAAAAYOD/A0u7k9HsJK5rAAAAAElFTkSuQmCC
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This assumes that the name for the source, in this case the historically famous first <a href="https://en.wikipedia.org/wiki/Quasar#Background">quasar</a> to be discovered, can be associated with a 4FGL catalog source. The plot shows, as a function of UTC (or MJD if desired) time, weekly measurements of deviations of the flux relative to the average of the 12-year interval used to define the 4FGL-DR3 catalog.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Overview">Overview<a class="anchor-link" href="#Overview"> </a></h2><p>This package has code that was developed with the <a href="https://nbdev.fast.ai/">nbdev</a> code/tests/documentation environment from the <a href="https://github.com/tburnett/lat-timing">github package lat-timing</a> to generate light curves of Fermi-LAT sources.<br>
It is based on a <a href="https://arxiv.org/pdf/1910.00140.pdf">paper</a> by Matthew Kerr, which derives the <a href="https://tburnett.github.io/wtlike/loglike#The-Kerr-likelihood-formula">weighted likelihood formalism</a> used here, specifically with
the <a href="https://arxiv.org/pdf/1207.5578.pdf">Bayesian Block</a> to detect and characterize variability of a gamma-ray source.</p>
<p>There are several innovative design features that significantly improve the speed and portability.</p>
<ul>
<li>Condensed photon and spacecraft data. </li>
<li>Weight tables</li>
<li>A cache to improve interactivity</li>
<li>Likelihood functions fit to a modified Poisson function</li>
<li>Unbinned likelihood </li>
<li>A simple user interface</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="How-it-works">How it works<a class="anchor-link" href="#How-it-works"> </a></h3><p>Historically, gamma-ray source measurements have used two methods:</p>
<ol>
<li>For a fixed time interval, where the energy and 
position are used, with a model including all potential sources and a model of the detector response to 
define the likelihood. This has been the only way to study weak sources. A light curve must apply this to
each time interval.</li>
<li>Or, for very bright flares, for example GRBs or AGN flares, one can simply count the number of photons within a
circular region, that is, aperture photometry.</li>
</ol>
<p>Matthew Kerr <a href="https://arxiv.org/pdf/1910.00140.pdf">introduced</a> a third method, basically counting photons but using information from a static
likelihood analysis to assign a "weight" to each photon, the probability for being from the source in question, then optimizing this likelihood. This assumes that the only thing changing is the flux of
the source.  He calls it "retrospective", since the analysis for the full time is then applied back to the individual photons. Another way of looking at it is to make the assumption that the time dependence of a source's photon flux factorizes according to the energy and spatitial dependences.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Likelihood-evaluation">Likelihood evaluation<a class="anchor-link" href="#Likelihood-evaluation"> </a></h3><p>In a significant modification from Kerr's implemetation as described in that paper, we evaluate weights for each photon by a table lookup.</p>
<p>Assumptions:</p>
<ul>
<li>Source photons are completely contained in the dataset boundaries (the "ROI").</li>
<li>The instrument response is constant with time.</li>
<li>The background pattern is constant. (Clearly violated if a neighboring source varies!)</li>
</ul>
<p>The likelihood evaluation is implemented in the module  <a href="https://tburnett.github.io/wtlike/loglike">loglike</a>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Photon-Data">Photon Data<a class="anchor-link" href="#Photon-Data"> </a></h3><p><em>Fermi</em> data are retrieved from the Fermi-LAT weekly data files extracted from the <a href="https://heasarc.gsfc.nasa.gov/FTP/fermi/data/lat/weekly">GSFC FTP server</a>, 
with subfolders for the photon data, <code>photon</code> and spacecraft data, <code>spacecraft</code>. It is <a href="http://fermi.gsfc.nasa.gov/ssc/data/access/http://fermi.gsfc.nasa.gov/ssc/data/access/">described here</a>. The files are organized into individual weeks, starting UTC midnight each Thursday. Files for the most recent week are updated daily.</p>
<p>We convert each pair of photon and spacecraft files to two DataFrame tables with the minimum information needed to evaluate the likelihood, as compressed as possible. Particularly, the energy and position are binned. Details can be seen in the module <a href="https://tburnett.github.io/wtlike/data_man">data_man</a>.</p>
<p>The entire data set (SOURCE class, energy&gt;100 MeV) in this format occupies ~2 GB.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Select-Data-for-a-source">Select Data for a source<a class="anchor-link" href="#Select-Data-for-a-source"> </a></h3><p>All further processing uses a subset of the photons within a cone, currently $4^\circ$, about the selected source, and 
evaluates the exposure during 30-s intervals for this direction.  In the class
<a href="/wtlikesource_data.html#SourceData"><code>SourceData</code></a>, implemented in the module 
<a href="/wtlikesource_data.html"><code>source_data</code></a> we</p>
<ol>
<li>Extract photons</li>
<li>Evaluate exposure, using the effective area tables and a spectral assumption.</li>
<li>Determine the weight for each photon, using the table for the source. See the module <a href="https://tburnett.github.io/wtlike/weights">weights</a> for details.</li>
</ol>
<p>The result is a photon DataFrame, containing for each photon, the time $t$ in MJD units, $w$.</p>
<p>This class is a superclass of the user interface class <a href="/wtlikemain.html#WtLike"><code>WtLike</code></a> introduced above.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Partition-into-cells">Partition into cells<a class="anchor-link" href="#Partition-into-cells"> </a></h3><p>A "cell", the terminology used by Kerr, the set of photons in a specific time interval. The class 
<a href="https://tburnett.github.io/wtlike/cell_data#CellData">CellData</a>
in the module <a href="https://tburnett.github.io/wtlike/cell_data">cell_data</a>, a subclass of SourceData manages this.</p>
<p>This class is instantiated with a tuple to define the binning in time. Denoted by <code>(a, b, c)</code>, the elements are:</p>
<ul>
<li><code>a</code>--start time </li>
<li><code>b</code>--stop time</li>
<li><code>c</code>-- bin size in days, but 0 means orbit-based, intervals are contiguous eposure.</li>
</ul>
<p>For the start and stop, values &gt; 50000 are interpreted as MJD. Otherwise they are relative to start if positive
or stop if negative for the full dataset, both rounded to a full day. Zero means actual start for <code>a</code> and stop for <code>b</code>.
The default binning is simply <code>(0, 0, 7)</code> for weekly bins with the full dataset. Hourly for the most recent week would be <code>(-7, 0, 1/24)</code>.</p>
<p>A DataFrame table of the cells is created as a data member <code>cells</code>, with content</p>
<ul>
<li><code>t</code> -- MJD time at cell center</li>
<li><code>tw</code> -- cell width in days</li>
<li><code>e</code> -- cell exposure, for reference </li>
<li><code>n</code> -- the number of photons</li>
<li><code>w</code> -- a list of <code>n</code> weights</li>
<li><code>S</code> -- expected number source photons, the nominal source rate times the total exposure.</li>
<li><code>B</code> -- expected number of background photons (unused)</li>
</ul>
<h3 id="Views">Views<a class="anchor-link" href="#Views"> </a></h3><p><a href="/wtlikecell_data.html#CellData"><code>CellData</code></a> implements a method <code>view</code>, which accepts a binning tuple as an argument, returns a <em>copy</em> of the current object, which can be a subclass, assigning to it the binning. Thus the view has all the attributes of its parent, but
with a different set of cells.</p>
<p>So the following creates a new WtLike object that we generated above, rebins a copy with 25-day bins in the first 100 days, generates a list of the cells, then removes it since it wasn't assigned a reference variable.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">wtl</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span><span class="o">.</span><span class="n">cells</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>CellData: Bin photon data into 4 25-day bins from 54683.0 to 54783.0
LightCurve: select 4 cells for fitting with e&gt;125 &amp; n&gt;2
         t    tw            e       ctm     n  \
0  54695.5  25.0  1489.317030  0.670382   553   
1  54720.5  25.0  1869.714868  0.681891  1438   
2  54745.5  25.0  1451.929805  0.679038  1183   
3  54770.5  25.0  1931.008354  0.682316  1175   

                                                   w           S           B  
0  [0.48901367, 0.8066406, 0.11303711, 0.19165039...  300.857212  532.021028  
1  [0.4345703, 0.6064453, 0.0690918, 0.056274414,...  377.701451  667.908582  
2  [0.33911133, 0.3100586, 0.7089844, 0.06994629,...  293.304612  518.665383  
3  [0.09112549, 0.58251953, 0.07537842, 0.3457031...  390.083359  689.804138  
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Evaluate-Likelihoods-and-make-light-curve-plots">Evaluate Likelihoods and make light curve plots<a class="anchor-link" href="#Evaluate-Likelihoods-and-make-light-curve-plots"> </a></h3><p>The class <a href="/wtlikelightcurve.html#LightCurve"><code>LightCurve</code></a>, implemented in the module <a href="/wtlikelightcurve.html"><code>lightcurve</code></a> is a subclass of <a href="/wtlikesource_data.html#SourceData"><code>SourceData</code></a>.
An instance invokes its superclass to generate the set of cells, then evaluates the likelihoods.</p>
<h4 id="Poisson-like-Likelihood">Poisson-like Likelihood<a class="anchor-link" href="#Poisson-like-Likelihood"> </a></h4><p>We fit the likelihood for each cell, using only a few evaluations, to a <a href="https://tburnett.github.io/poisson">3-parameter Poisson-like formula</a>. Two advantages of this are:</p>
<ul>
<li>efficiency -- for large numbers of photons, this is much faster</li>
<li>convenience -- the <a href="/wtlikepoisson.html#Poisson"><code>Poisson</code></a> object implements functions that return the TS, 95% CL, maximum, and uncertainties, using the <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.gammainc.html">incomplete gamma function</a>.</li>
</ul>
<p>This results in a DataFrame <code>fits</code> containing</p>
<ul>
<li><code>t, tw, n</code>, from the cell, and</li>
<li><code>fit</code>, the <a href="/wtlikepoisson.html#Poisson"><code>Poisson</code></a> object</li>
</ul>
<h4 id="Light-curve-plots">Light curve plots<a class="anchor-link" href="#Light-curve-plots"> </a></h4><p>The function <code>Likelihood.plot</code> actually invokes <a href="/wtlikelightcurve.html#flux_plot"><code>flux_plot</code></a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Apply-Bayesian-Blocks">Apply Bayesian Blocks<a class="anchor-link" href="#Apply-Bayesian-Blocks"> </a></h3><p>The class <a href="/wtlikemain.html#WtLike"><code>WtLike</code></a>, 
implememted in the module <a href="/wtlikemain.html"><code>main</code></a>, adds an implementation of the Bayesian Block (BB) algorithm, from the module <a href="/wtlikebayesian.html"><code>bayesian</code></a>  using likelihood instead of counts.
There we have two subclasses of <code>astropy.stats.bayesian_blocks</code>, <a href="/wtlikebayesian.html#CountFitness"><code>CountFitness</code></a> and the default <a href="/wtlikebayesian.html#LikelihoodFitness"><code>LikelihoodFitness</code></a>.</p>
<p>This code creates partitions between boundaries of a set of cells. Usage is via a special view, 
<a href="https://tburnett.github.io/wtlike/main#WtLike.bb_view">bb_view`</a></p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
    <span class="n">bb</span> <span class="o">=</span> <span class="n">wtl</span><span class="o">.</span><span class="n">bb_view</span><span class="p">()</span>
    <span class="n">bb</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">UTC</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Bayesian Blocks: partitioning 156 cells using LikelihoodFitness with penalty 5%
	found 43 / 156 blocks.
LightCurve: Loaded 43 / 43 cells for fitting
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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iIJVUAfNviCTyZCfn4+nn34aDQ0NuOuuuxAaqn+b09PTcebMGbRv3x6ff/457rvvPpSWlqJDhw7Ytm0bAKCqqgqvvfYaPv30U8ydOxdVVVV45plnkJWVZXcZJk2aBAAYOHAg6urqEB0djejoaERERODatWtuP2YiIiKiYOex9IzZs2eja9euSEtLMyyrrKxEdnY2+vbti+zsbFRVVXlq9wD0NcjG/6SWu0tWVha+++47FBQUYNSoUejbty8AICYmBu3btwcATJgwAU1NTbh69arJaxcvXowXX3wR69atw5AhQ7B69Wr84Q9/cGj/4eHhAAC5XG74W3wsdkokIiIiIvt5LGh+9NFHsWPHDpNlr776Ku68806UlpbizjvvxKuvvuqp3fvU5cuXAQANDQ147bXXDCkRFy9ehCAIAICCggLodDp06dLF8LrS0lJcuHABo0ePRn19PeRyOWQyGTQajcfKGh0djdraWo9tn4iIiCgYeCxoHjVqFDp37myybPPmzcjJyQEA5OTkmAyvFkzeeOMNpKSkYNCgQbj33nsxduxYAMCGDRuQlpaGwYMHY8GCBcjPz4dMJjO87sUXX8TSpUsBADNmzMCHH36IzMxMPPvssx4r6x133IGjR4+yIyARERFRK2SCWPXpASqVCvfccw+Ki4sBAB07djTJqe3UqZNdKRoZGRkoLCx0uTxiB0BPpGRQ61QqFZKSknxdDApA4n2leKUyfxyMeL4Q2YfnCnmCrbjTbzsC5uXlIS8vD4A+rUGlUrm+UdmN/Gp3bIscUlFR4esiUMBKAgCja4D54+DD84XIPjxXyJu8GjR369YN5eXliIuLQ3l5Obp27Wpz3dzcXOTm5gLQR/y8kwx8/AzJFebfn2D/PgX78RG5C88V8havTm4yadIkw+x4a9asweTJk725eyIiIiIip3gsaJ4xYwaysrJw/PhxJCQkYNWqVXjhhRfw5Zdfom/fvvjyyy/xwgsveGr3RERERERu47H0jHXr1lldvmvXLk/tkoiIiIjII7yankFEREREFIgYNBMRERERSWDQTEREREQkgUEzEREREZEEBs1ERERERBIYNBMRERERSWDQTEREREQkgUEzEREREZEEBs1ERERERBIYNBMRERERSWDQTEREREQkgUEzEREREZEEBs1ERERERBIYNBMRERERSWDQTEREREQkgUEz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6Oho7N+/H4Ig4KOPPpJ8DVEgcde5QuQRApETvvvuOwGAMHDgQGHw4MHC4MGDhW3btglXr14Vxo4dK/Tp00cYO3asUFFRYXjN0qVLhV69egnJycnC559/blj+4IMPCikpKUJKSoqwbt06XxwOkUc5c77ccsstQqdOnYR27doJ8fHxQklJiSAIgvDf//5XSE1NFXr16iXMmzdP0Ol0vjosIrdz57ny3HPPCfHx8YJMJhPi4+OFl19+2UdHRcGC02gTEREREUlgegYRERERkQQGzUREREREEhg0ExERERFJYNBMRERERCSBQTMRERERkQQGzUREAUilUiEtLc1k2SuvvIJ27dpBqVRiwIABiIyMhFKphFKpxIYNG1BQUIBRo0ahX79+6N+/P+bMmYP6+nofHQERUWDhNNpEREFk0aJFePbZZ6FSqXDPPfegqKgIAHDp0iUMHToU+fn5yMrKgiAI2LhxI2praxEVFeXbQhMRBQAGzUREbcCKFSuQk5ODrKwsAIBMJsO0adN8XCoiosDB9AwiojaguLgYQ4YM8XUxiIgCFoNmIqIAJJPJHFpORESuYdBMRBSAunTpgqqqKpNllZWViI2Ntbp+amoqDhw44I2iEREFJQbNREQBqH379oiLi8OuXbsA6APmHTt2YMSIEVbXnz9/PtasWYMff/zRsOzf//43Ll686JXyEhEFOnYEJCIKUB999BHmzZuHZ555BgDw8ssvo3fv3lbX7datG/Lz8/Hss8/i8uXLkMvlGDVqFKZMmeLNIhMRBSyZIAiCrwtBREREROTPmJ5BRERERCSBQTMRERERkQQGzUREREREEhg0ExERERFJYNBMRERERCSBQTMRERERkQQGzUREREREEv4/M3gbWtpvDeIAAAAASUVORK5CYII=
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you see, this made 94 blocks from the 656 weeks, fit each, and overplotted in on the weekly light curve.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Simulation">Simulation<a class="anchor-link" href="#Simulation"> </a></h3><p>Finally, a simulation option is available. See the <a href="https://tburnett.github.io/wtlike/tutorial/">tutorial</a>  for an example</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Installation">Installation<a class="anchor-link" href="#Installation"> </a></h2><p>Note that this is in beta mode. 
It depends on the packages:  matplotlib, pandas, scipy, astropy, and healpy, which pip should install if needed.</p>
<p>To install from pyPI:</p>

<pre><code>pip install wtlike</code></pre>
<p>or</p>

<pre><code>pip install -U wtlike</code></pre>
<p>to upgrade.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Input-data">Input data<a class="anchor-link" href="#Input-data"> </a></h2><p>There are three data sources which <code>wtlike</code> needs to function:</p>
<ul>
<li>The photon/spacecraft data</li>
<li>A table of weights for each source</li>
<li>An effective area IRF table </li>
</ul>
<p>These must be found under a folder, which by default is <code>~/wtlike_data</code>. In that folder there must be (perhaps links to) three folders named <code>data_files</code>, <code>weight_files</code>, <code>aeff_files</code>, and a zip file, <code>weight_file.zip</code>.  A copy of what I'm using is at <code>/afs/slac/g/glast/users/burnett/wtlike_data</code></p>

</div>
</div>
</div>
</div>
 

