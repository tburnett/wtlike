---

title: Light Curve Generation

keywords: fastai
sidebar: home_sidebar

summary: "Generate light curves from cells"
description: "Generate light curves from cells"
nb_path: "nbs/09_lightcurve.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/09_lightcurve.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A "light curve" is a table with columns</p>
<ul>
<li><code>t</code> -- time in MJD </li>
<li><code>tw</code> -- the cell width</li>
<li><code>n</code>  -- number of photons</li>
<li><code>e</code>  -- exposure, in $10^6 s\ cm^2$ units</li>
<li><code>fit</code> -- the fit object, containing info about the flux. This is usually a <a href="/wtlikeloglike#PoissonRep"><code>PoissonRep</code></a> object</li>
</ul>
<p>It is generated from a set of cells</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CellFitter" class="doc_header"><code>class</code> <code>CellFitter</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/lightcurve.py#L15" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CellFitter</code>(<strong><code>config</code></strong>, <strong><code>cells</code></strong>, <strong><code>source_name</code></strong>, <strong><code>rep_name</code></strong>:<code>likelihood rep name</code>=<em><code>''</code></em>)</p>
</blockquote>
<p>Apply likelihood fits to a set of cells</p>
<p>parameters:</p>
<ul>
<li>cells : a table with index t, columns  tw, n, e, w, S, B</li>
<li>exp_min : minimum fractional exposure allowed</li>
<li>rep_name : represention to use</li>
</ul>
<p>Generates a DataFrame with columns n, ep, fit</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fit_cells" class="doc_header"><code>fit_cells</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/lightcurve.py#L82" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fit_cells</code>(<strong><code>config</code></strong>, <strong><code>input_cells</code></strong>, <strong><code>repcl</code></strong>=<em><code>'PoissonRep'</code></em>)</p>
</blockquote>
<p>Apply fits to the likelihoods for a set of cells
return light-curve dataframe</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="getCellFitter" class="doc_header"><code>getCellFitter</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/lightcurve.py#L108" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>getCellFitter</code>(<strong><code>config</code></strong>, <strong><code>source</code></strong>, <strong><code>cell_query</code></strong>=<em><code>'e&gt;1e-6'</code></em>, <strong><code>key</code></strong>=<em><code>''</code></em>)</p>
</blockquote>
<p>Returns a lightcurve table for the source</p>
<ul>
<li><code>source</code> -- a PointSource object</li>
<li><code>cell query</code> -- query to apply to cell selection</li>
<li><code>bin_edges</code> -- optional to select other than default described in config</li>
<li><code>key</code> -- optional cache key. Set to None to disable cache use</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fit_table" class="doc_header"><code>fit_table</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/lightcurve.py#L133" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fit_table</code>(<strong><code>lc</code></strong>, <strong><code>expect</code></strong>=<em><code>1.0</code></em>)</p>
</blockquote>
<p>Generate a summary table from a light curve dataframe</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="flux_plot" class="doc_header"><code>flux_plot</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/lightcurve.py#L147" class="source_link" style="float:right">[source]</a></h3><blockquote><p><code>flux_plot</code>(<strong><code>cell_fits</code></strong>, <strong><code>query</code></strong>=<em><code>''</code></em>, <strong><code>ax</code></strong>=<em><code>None</code></em>, <strong><code>fignum</code></strong>=<em><code>1</code></em>, <strong><code>figsize</code></strong>=<em><code>(12, 4)</code></em>, <strong><code>log</code></strong>=<em><code>False</code></em>, <strong><code>title</code></strong>=<em><code>None</code></em>, <strong><code>step</code></strong>=<em><code>False</code></em>, <strong><code>tzero</code></strong>:<code>time offset</code>=<em><code>0</code></em>, <strong><code>flux_factor</code></strong>=<em><code>1</code></em>, <strong><code>colors</code></strong>=<em><code>('cornflowerblue', 'sandybrown', 'blue')</code></em>, <strong><code>fmt</code></strong>=<em><code>''</code></em>, <strong><code>ms</code></strong>=<em><code>None</code></em>, <strong><code>error_pixsize</code></strong>=<em><code>10</code></em>, <strong><code>limit_fmt</code></strong>=<em><code>None</code></em>, <strong><code>source_name</code></strong>=<em><code>None</code></em>, <strong><code>legend_loc</code></strong>=<em><code>'upper left'</code></em>, <strong><code>error_lw</code></strong>=<em><code>2</code></em>, <strong><code>ts_bar_min</code></strong>=<em><code>4</code></em>, <strong><code>zorder</code></strong>=<em><code>0</code></em>, <strong><code>errorbar_args</code></strong>=<em><code>{}</code></em>, <strong><code>axhline</code></strong>=<em><code>{}</code></em>, <strong>**<code>kwargs</code></strong>)</p>
</blockquote>
<p>Make a plot of flux vs. time. This is invoked by the <code>plot</code> function of <a href="/wtlikelightcurve#LightCurve"><code>LightCurve</code></a></p>
<ul>
<li>cell_fits -- cell fits DataFrame</li>
<li>query ['']-- DataFrame query to select subset</li>
<li>ts_bar_min -- threshold for plotting as bar vs limit</li>
<li>tzero -- time offset, in MJD</li>
<li>source_name -- draw text in top left</li>
<li><p>flux_factor [1]</p>
</li>
<li><p>ax [None] -- a matplotlib.axes._subplots.AxesSubplot object returned from plt.subplots<br>
if None, create one using subplots with fignum [1] and figsize [(12,4)]</p>
</li>
<li>fmt [''] -- marker symbol -- if not specifed, will use '.' if many bins, else 'o'</li>
<li>ms [None] -- for marker size</li>
<li>colors -- tuple of colors for signal, limit, step</li>
<li>step   -- add a "step" plot</li>
<li>zorder -- set to different number to order successive calls with same Axis object</li>
<li>kwargs -- apply to the <code>ax</code> object, like xlim, ylim</li>
</ul>
<p>returns the Figure instance</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Example plot-- the first 100 days of Fermi data for Geminga</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And forcing upper limits</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fit_beta_free" class="doc_header"><code>fit_beta_free</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/lightcurve.py#L295" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fit_beta_free</code>()</p>
</blockquote>
<p>Make a plot of $\alpha$ and $\beta$ for the given source</p>
<p>Uses the current cells, assuming Gaussian errors, fitting each to $\alpha$ and $\beta$</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="plot_beta_free" class="doc_header"><code>plot_beta_free</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/lightcurve.py#L309" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>plot_beta_free</code>(<strong><code>abdf</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary data-open="Hide Code" data-close="Show Code"></summary>
        <summary></summary>
        <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># config=Config()</span>
<span class="c1"># fig, (ax1,ax2) = plt.subplots(1,2, figsize=(12,4), sharex=True, sharey=True)</span>
<span class="c1"># flux_plot(config, lc.lc_df, ax=ax1, fmt=&#39;o&#39;, xlim=(54689, 54700),  step=True)</span>
<span class="c1"># flux_plot(config, lc.lc_df, ax=ax2, fmt=&#39;o&#39;, xlim=(54689, 54700), ts_bar_min=1000, step=True, step_label=&#39;step&#39;)</span>
<span class="c1">#fig.set_facecolor(&#39;white&#39;);</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LightCurve" class="doc_header"><code>class</code> <code>LightCurve</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/lightcurve.py#L327" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LightCurve</code>(<strong>*<code>pars</code></strong>, <strong>**<code>kwargs</code></strong>) :: <a href="/wtlikecell_data#CellData"><code>CellData</code></a></p>
</blockquote>
<p>Full analysis of a source,
Inherits from <a href="/wtlikecell_data#CellData"><code>CellData</code></a></p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="s1">&#39;3C 279&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="c1"># fig=lc.plot( show_flux=True, ylim=(2e-2,4),tzero=54720, fmt=&#39;o&#39;, xlim=(0,50), log=True, ms=8, </span>
<span class="c1">#             error_pixsize=20)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>SourceData: photons and exposure for 3C 279: Saving to cache with key &#34;3C_279_data&#34;
	Assembling photon data and exposure for source 3C 279 from folder &#34;/home/burnett/wtlike_data/data_files&#34;,
	 with 669 files, last file:  week_678.pkl: loading all files
.</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-14-4c41a1e49aa8&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>lc <span class="ansi-blue-fg">=</span> LightCurve<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;3C 279&#39;</span><span class="ansi-blue-fg">,</span> bins<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">,</span><span class="ansi-cyan-fg">100</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span class="ansi-red-fg"># fig=lc.plot( show_flux=True, ylim=(2e-2,4),tzero=54720, fmt=&#39;o&#39;, xlim=(0,50), log=True, ms=8,</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span class="ansi-red-fg">#             error_pixsize=20)</span>

<span class="ansi-green-fg">&lt;ipython-input-13-1cd6805211a6&gt;</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, *pars, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     10</span>         self<span class="ansi-blue-fg">.</span>n_min <span class="ansi-blue-fg">=</span> kwargs<span class="ansi-blue-fg">.</span>pop<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;n_min&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     11</span>         self<span class="ansi-blue-fg">.</span>lc_key <span class="ansi-blue-fg">=</span> kwargs<span class="ansi-blue-fg">.</span>pop<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;lc_key&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 12</span><span class="ansi-red-fg">         </span>super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__init__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>pars<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     13</span>         self<span class="ansi-blue-fg">.</span>update<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     14</span> 

<span class="ansi-green-fg">/mnt/c/users/thbur/OneDrive/work/wtlike/wtlike/cell_data.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, *pars, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     30</span>         bins <span class="ansi-blue-fg">=</span> kwargs<span class="ansi-blue-fg">.</span>pop<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;bins&#39;</span><span class="ansi-blue-fg">,</span> kwargs<span class="ansi-blue-fg">.</span>pop<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;time_bins&#39;</span><span class="ansi-blue-fg">,</span> Config<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>time_bins<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     31</span>         <span class="ansi-red-fg">#  load source data</span>
<span class="ansi-green-fg">---&gt; 32</span><span class="ansi-red-fg">         </span>super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>__init__<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>pars<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs <span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     33</span> 
<span class="ansi-green-intense-fg ansi-bold">     34</span> 

<span class="ansi-green-fg">/mnt/c/users/thbur/OneDrive/work/wtlike/wtlike/source_data.py</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, source, config, clear, week_range, key)</span>
<span class="ansi-green-intense-fg ansi-bold">    426</span>                             _load_from_weekly_data<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>config<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>source<span class="ansi-blue-fg">,</span> week_range<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    427</span>                             overwrite<span class="ansi-blue-fg">=</span>clear<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">--&gt; 428</span><span class="ansi-red-fg">                             description=f&#39;SourceData: photons and exposure for {self.source_name}&#39;)
</span><span class="ansi-green-intense-fg ansi-bold">    429</span>             photons<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>exposure <span class="ansi-blue-fg">=</span> r<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">:</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-intense-fg ansi-bold">    430</span>             self<span class="ansi-blue-fg">.</span>runs <span class="ansi-blue-fg">=</span> r<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">]</span> <span class="ansi-green-fg">if</span> len<span class="ansi-blue-fg">(</span>r<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">==</span><span class="ansi-cyan-fg">3</span> <span class="ansi-green-fg">else</span> <span class="ansi-green-fg">None</span>

<span class="ansi-green-fg">/mnt/c/users/thbur/OneDrive/work/wtlike/wtlike/config.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, key, func, description, overwrite, *pars, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    144</span> 
<span class="ansi-green-intense-fg ansi-bold">    145</span>         <span class="ansi-green-fg">if</span> ret <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">or</span> overwrite<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 146</span><span class="ansi-red-fg">             </span>ret <span class="ansi-blue-fg">=</span> func<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>pars<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    147</span>             self<span class="ansi-blue-fg">.</span>add<span class="ansi-blue-fg">(</span>key<span class="ansi-blue-fg">,</span> ret<span class="ansi-blue-fg">,</span> exist_ok<span class="ansi-blue-fg">=</span>overwrite<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    148</span>         <span class="ansi-green-fg">return</span> ret

<span class="ansi-green-fg">/mnt/c/users/thbur/OneDrive/work/wtlike/wtlike/source_data.py</span> in <span class="ansi-cyan-fg">_load_from_weekly_data</span><span class="ansi-blue-fg">(config, source, week_range)</span>
<span class="ansi-green-intense-fg ansi-bold">    328</span>             week <span class="ansi-blue-fg">=</span> pickle<span class="ansi-blue-fg">.</span>load<span class="ansi-blue-fg">(</span>inp<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    329</span> 
<span class="ansi-green-fg">--&gt; 330</span><span class="ansi-red-fg">         </span>photons <span class="ansi-blue-fg">=</span> _get_photons_near_source<span class="ansi-blue-fg">(</span>config<span class="ansi-blue-fg">,</span> source<span class="ansi-blue-fg">,</span> week <span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    331</span>         exposure <span class="ansi-blue-fg">=</span> _calculate_exposure_for_source<span class="ansi-blue-fg">(</span>config<span class="ansi-blue-fg">,</span> source<span class="ansi-blue-fg">,</span> week <span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    332</span>         <span class="ansi-green-fg">if</span> photons <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">not</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/mnt/c/users/thbur/OneDrive/work/wtlike/wtlike/source_data.py</span> in <span class="ansi-cyan-fg">_get_photons_near_source</span><span class="ansi-blue-fg">(config, source, week)</span>
<span class="ansi-green-intense-fg ansi-bold">    151</span> 
<span class="ansi-green-intense-fg ansi-bold">    152</span>     <span class="ansi-red-fg"># times: convert to float, add tstart, convert to MJD</span>
<span class="ansi-green-fg">--&gt; 153</span><span class="ansi-red-fg">     </span>time <span class="ansi-blue-fg">=</span> MJD<span class="ansi-blue-fg">(</span>np<span class="ansi-blue-fg">.</span>array<span class="ansi-blue-fg">(</span>dfc<span class="ansi-blue-fg">.</span>time<span class="ansi-blue-fg">,</span> float<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">+</span>tstart<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    154</span> 
<span class="ansi-green-intense-fg ansi-bold">    155</span>     <span class="ansi-red-fg"># assemble the DataFrame, remove those outside the radius</span>

<span class="ansi-green-fg">/mnt/c/users/thbur/OneDrive/work/wtlike/wtlike/config.py</span> in <span class="ansi-cyan-fg">MJD</span><span class="ansi-blue-fg">(arg)</span>
<span class="ansi-green-intense-fg ansi-bold">    254</span> <span class="ansi-green-fg">def</span> MJD<span class="ansi-blue-fg">(</span>arg<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    255</span>     <span class="ansi-blue-fg">&#34;convert MET or UTC to MJD&#34;</span>
<span class="ansi-green-fg">--&gt; 256</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">if</span> np<span class="ansi-blue-fg">.</span>isreal<span class="ansi-blue-fg">(</span>arg<span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">or</span> hasattr<span class="ansi-blue-fg">(</span>arg<span class="ansi-blue-fg">,</span> length<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    257</span>         <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">(</span>mission_start <span class="ansi-blue-fg">+</span> arg<span class="ansi-blue-fg">/</span>day  <span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    258</span>     <span class="ansi-green-fg">while</span> len<span class="ansi-blue-fg">(</span>arg<span class="ansi-blue-fg">.</span>split<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;-&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">&lt;</span><span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">ValueError</span>: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">debug</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lc</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

