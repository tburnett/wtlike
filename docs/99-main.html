---

title: wtlike interface


keywords: fastai
sidebar: home_sidebar

summary: "Top-level interface to the rest of the package"
description: "Top-level interface to the rest of the package"
nb_path: "nbs/99-main.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/99-main.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="WtLike" class="doc_header"><code>class</code> <code>WtLike</code><a href="" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>WtLike</code>(<strong>*<code>pars</code></strong>, <strong>**<code>kwargs</code></strong>) :: <a href="/wtlikelightcurve.html#LightCurve"><code>LightCurve</code></a></p>
</blockquote>
<p>Inherit from <a href="/wtlikelightcurve.html#LightCurve"><code>LightCurve</code></a> and add Bayesian Block capability</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># code for the demo--this shouid be collapsed</span>
<span class="k">def</span> <span class="nf">demo</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ## Test/Demonstration with 3C 279</span>
<span class="sd">    </span>
<span class="sd">    &gt; Note that this also demonstrates using `nbdoc` to have a single Jupyterlab cell generate a document</span>
<span class="sd">    </span>
<span class="sd">    First, the weekly light curve:</span>
<span class="sd">    {out1}    {fig1}</span>
<span class="sd">    </span>
<span class="sd">    Replot the figure with an expanded scale to see position of a flare:</span>
<span class="sd">    {fig2}</span>
<span class="sd">    {out3}    {fig3}</span>
<span class="sd">    {out4}    {fig4}</span>
<span class="sd">    </span>
<span class="sd">    Table of BB fits</span>
<span class="sd">    {bb_table}</span>
<span class="sd">    </span>
<span class="sd">    This can be compared with Figure 4 from the [Kerr paper](https://arxiv.org/pdf/1910.00140.pdf)</span>
<span class="sd">    {kerr_fig4}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">full</span>
    
    <span class="k">with</span> <span class="n">capture_print</span><span class="p">(</span><span class="s1">&#39;Create full weekly light curve&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out1</span><span class="p">:</span>
        <span class="n">full</span> <span class="o">=</span> <span class="n">WtLike</span><span class="p">(</span><span class="s1">&#39;3C 279&#39;</span><span class="p">)</span>
    
    <span class="n">fig1</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span>
        <span class="n">full</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">yscale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span> <span class="n">ts_min</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;MJD&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">fignum</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>  
    
    <span class="n">fig2</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span>
        <span class="n">full</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>  <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;MJD&#39;</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">fignum</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="n">xlim</span><span class="o">=</span><span class="p">(</span><span class="mi">57100</span><span class="p">,</span> <span class="mi">57300</span><span class="p">),),</span>
        <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>  
    
    <span class="k">with</span> <span class="n">capture_print</span><span class="p">(</span><span class="s1">&#39;Define orbit-based subset around large flare at MJD 57189&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out3</span><span class="p">:</span>
        <span class="n">orbit</span> <span class="o">=</span> <span class="n">full</span><span class="o">.</span><span class="n">view</span><span class="p">((</span><span class="mi">57186</span><span class="p">,</span> <span class="mi">57191</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">fig3</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span>
        <span class="n">orbit</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">tzero</span><span class="o">=</span><span class="mi">57186</span><span class="p">,</span>  <span class="n">ts_min</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>   <span class="n">fignum</span><span class="o">=</span><span class="mi">3</span> <span class="p">),</span>
            <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    
    <span class="k">with</span> <span class="n">capture_print</span><span class="p">(</span><span class="s1">&#39;Apply BB and overplot it with the cells on which it is based&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out4</span><span class="p">:</span>
        <span class="n">bborbit</span> <span class="o">=</span> <span class="n">orbit</span><span class="o">.</span><span class="n">bb_view</span><span class="p">()</span>
    <span class="n">fig4</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span>
        <span class="n">bborbit</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">tzero</span><span class="o">=</span><span class="mi">57186</span><span class="p">,</span>  <span class="n">ts_min</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>   <span class="n">fignum</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span>
                <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
    
    <span class="n">bb_table</span> <span class="o">=</span> <span class="n">orbit</span><span class="o">.</span><span class="n">fluxes</span>
    
    <span class="n">kerr_fig4</span> <span class="o">=</span> <span class="n">image</span><span class="p">(</span><span class="s1">&#39;kerr_fig4.png&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">caption</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">locals</span><span class="p">()</span>

<span class="n">nbdoc</span><span class="p">(</span><span class="n">demo</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Test/Demonstration-with-3C-279">Test/Demonstration with 3C 279<a class="anchor-link" href="#Test/Demonstration-with-3C-279"> </a></h2><blockquote><p>Note that this also demonstrates using <code>nbdoc</code> to have a single Jupyterlab cell generate a document</p>
</blockquote>
<p>First, the weekly light curve:</p>
<p><details  class="nbdoc-description" >  <summary> Create full weekly light curve </summary>  <div style="margin-left: 5%"><pre>SourceData: photons and exposure for 3C 279: Restoring from cache with key "3C 279_data"<br>WtLike: Source 3C 279 with:<br>    data:       179,712 photons from   2008-08-04 to 2021-05-05<br>     exposure: 2,818,132 intervals from 2008-08-04 to 2021-05-06<br>CellData: Bin photon data into 665 1-week bins from 54683.0 to 59338.0<br>LightCurve: select 656 cells for fitting with e&gt;0.5 & n&gt;2<br></pre></div> </details>    <div class="nbdoc_image"></p>
<p><figure style="margin-left: 5%" title="Figure 1">  <a href="images/demo_fig_01.png" title="images/demo_fig_01.png">    <img src="images/demo_fig_01.png" alt="Figure 1 at images/demo_fig_01.png" width=600>   </a> </figure>
&lt;/div&gt;</p>
<p>Replot the figure with an expanded scale to see position of a flare:</p>
<div class="nbdoc_image">
<figure style="margin-left: 5%" title="Figure 2">  <a href="images/demo_fig_02.png" title="images/demo_fig_02.png">    <img src="images/demo_fig_02.png" alt="Figure 2 at images/demo_fig_02.png" width=600>   </a> </figure>
</div><p><details  class="nbdoc-description" >  <summary> Define orbit-based subset around large flare at MJD 57189 </summary>  <div style="margin-left: 5%"><pre>CellData: Bin photon data into 80 orbit-based bins from 57186.1 to 57191.0<br>LightCurve: select 61 cells for fitting with e&gt;0.5 & n&gt;2<br></pre></div> </details>    <div class="nbdoc_image"></p>
<p><figure style="margin-left: 5%" title="Figure 3">  <a href="images/demo_fig_03.png" title="images/demo_fig_03.png">    <img src="images/demo_fig_03.png" alt="Figure 3 at images/demo_fig_03.png" width=600>   </a> </figure>
&lt;/div&gt;</p>
<p><details  class="nbdoc-description" >  <summary> Apply BB and overplot it with the cells on which it is based </summary>  <div style="margin-left: 5%"><pre>LightCurve: select 61 cells for fitting with e&gt;0.5 & n&gt;2<br>Partitioned 61 cells into 10 blocks, using LikelihoodFitness <br>LightCurve: Loaded 10 / 10 cells for fitting<br></pre></div> </details>    <div class="nbdoc_image"></p>
<p><figure style="margin-left: 5%" title="Figure 4">  <a href="images/demo_fig_04.png" title="images/demo_fig_04.png">    <img src="images/demo_fig_04.png" alt="Figure 4 at images/demo_fig_04.png" width=600>   </a> </figure>
&lt;/div&gt;</p>
<p>Table of BB fits</p>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>t</th>
      <th>tw</th>
      <th>n</th>
      <th>ts</th>
      <th>flux</th>
      <th>errors</th>
      <th>limit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>57186.116</td>
      <td>0.017</td>
      <td>3</td>
      <td>12.800</td>
      <td>1.498</td>
      <td>(-0.745, 1.096)</td>
      <td>4.006</td>
    </tr>
    <tr>
      <td>57186.253</td>
      <td>0.025</td>
      <td>11</td>
      <td>19.200</td>
      <td>2.693</td>
      <td>(-0.998, 1.264)</td>
      <td>5.260</td>
    </tr>
    <tr>
      <td>57186.385</td>
      <td>0.026</td>
      <td>10</td>
      <td>21.300</td>
      <td>2.743</td>
      <td>(-0.989, 1.246)</td>
      <td>5.263</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>57190.831</td>
      <td>0.012</td>
      <td>9</td>
      <td>29.100</td>
      <td>3.833</td>
      <td>(-1.332, 1.695)</td>
      <td>7.289</td>
    </tr>
    <tr>
      <td>57190.898</td>
      <td>0.009</td>
      <td>4</td>
      <td>5.700</td>
      <td>1.792</td>
      <td>(-1.028, 1.527)</td>
      <td>5.314</td>
    </tr>
    <tr>
      <td>57190.966</td>
      <td>0.006</td>
      <td>3</td>
      <td>2.700</td>
      <td>2.005</td>
      <td>(-1.435, 2.221)</td>
      <td>7.306</td>
    </tr>
  </tbody>
</table>
</div><p>This can be compared with Figure 4 from the <a href="https://arxiv.org/pdf/1910.00140.pdf">Kerr paper</a></p>
<div class="nbdoc_image">
<figure style="margin-left: 5%" title="Figure 5">  <a href="images/demo_fig_05.png" title="images/demo_fig_05.png">    <img src="images/demo_fig_05.png" alt="Figure 5 at images/demo_fig_05.png" width=600>   </a> </figure>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

