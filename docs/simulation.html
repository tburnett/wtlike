---

title: Simulation

keywords: fastai
sidebar: home_sidebar

summary: "Generate simulated cells using the weighted likelihood"
description: "Generate simulated cells using the weighted likelihood"
nb_path: "nbs/10_simulation.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/10_simulation.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For simulation the distribution of weights is required. That can be a histogram or a function, an input to the <code>_WeightGenerator</code> class. The class is a functor, with the argument a number on the range (0,1).  Passing an array of uniform random numbers then creates set of weights distributed according to the model represented by the input weight distribution.</p>
<p>To account for different levels of signal or background than that represented by the full dataset, the <code>_WeightGenerator</code> class accepts <code>alpha</code>($\alpha$) and <code>beta</code> ($\beta$) parameters, which will be used to weight the weight distribution  by a factor</p>
$$ \big(1 + \alpha\ w + \beta \ (1-w)\ \big), $$<p>where $w$ represents an array of weight values.</p>
<p>Generating a cell requires also the expected number of photons. If the average flux and exposure predict a number of events $\mu$, we select the actual number from the Poisson distribution.</p>
<p>This is done by <a href="/wtlikesimulation#generate_cell"><code>generate_cell</code></a>, which creates a list of weights depending on $\alpha$, $\beta$, and $\mu$.</p>
<p>Finally, <a href="/wtlikesimulation#simulate_cells"><code>simulate_cells</code></a> makes a list of cells, based on the actual exposure of a source.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="_Sampler" class="doc_header"><code>class</code> <code>_Sampler</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/simulation.py#L20" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>_Sampler</code>(<strong><code>func</code></strong>, <strong><code>limits</code></strong>=<em><code>(0, 1)</code></em>, <strong><code>n</code></strong>=<em><code>100</code></em>)</p>
</blockquote>
<p>Sample an arbitrary function or histogram</p>
<ul>
<li>func -- a function, a histogram, or a fixed value<br>
  If a function, must be positive definite.<br>
  Assume histogram bins are 0 to 1.</li>
<li>a,b  -- limits (default 0,1)</li>
<li>n    -- table size (ignored if a histogram or value)</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Gaussian-and-quadratic-example-functions">Gaussian and quadratic example functions<a class="anchor-link" href="#Gaussian-and-quadratic-example-functions"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary data-open="Hide Code" data-close="Show Code"></summary>
        <summary></summary>
        <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">sf</span> <span class="o">=</span> <span class="n">_Sampler</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">limits</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">sf</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">tests</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">()),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">])</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">tests</span><span class="o">&lt;</span><span class="mf">5e-2</span> <span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;Failed Tests: mean </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s1">, std </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span>

<span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="n">wfun</span> <span class="o">=</span> <span class="n">_Sampler</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

<span class="n">test2</span> <span class="o">=</span> <span class="n">wfun</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">wfun</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">test2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">test2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Not almost equal: </span><span class="si">{</span><span class="n">test2</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>

    </div>
</div>
</div>

    </details>
</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Test-generating-weights-from-a-source-weight-histogram">Test generating weights from a source weight histogram<a class="anchor-link" href="#Test-generating-weights-from-a-source-weight-histogram"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary data-open="Hide Code" data-close="Show Code"></summary>
        <summary></summary>
        <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">(</span><span class="n">wtlike_data</span><span class="o">=</span><span class="s1">&#39;~/wtlike_data&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">source</span> <span class="o">=</span> <span class="n">PointSource</span><span class="p">(</span><span class="s1">&#39;Geminga&#39;</span><span class="p">)</span>
    <span class="n">photon_data</span> <span class="o">=</span> <span class="n">SourceData</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">photon_data</span><span class="o">.</span><span class="n">weight_histogram</span><span class="p">()</span>
    <span class="n">sf</span> <span class="o">=</span> <span class="n">_Sampler</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">sf</span><span class="p">(</span><span class="mi">10000</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> 
            <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;simulation with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s1"> samples&#39;</span><span class="p">);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">step</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">h</span><span class="p">])</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">),</span>
           <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;data, source </span><span class="si">{</span><span class="n">source</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">));</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>photons and exposure for Geminga: Restoring from cache with key &#34;Geminga__data&#34;
SourceData: Source Geminga with:
	 data:     1,412,008 photons from   2008-08-04 to 2021-04-28
	 exposure: 3,112,161 intervals from 2008-08-04 to 2021-04-28
Weight histogram for Geminga: Saving to cache with key &#34;Geminga_weight_hist&#34;
</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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8cwzz5Tav0OHDuzevbvU9o0aNaJdu3YUFBTw7LPPkpZ2ZIScxYsXVzh607Zt21i4cCG5ubmEh4cTERHhrlnecMMNPPfccxw6dIjExESeffZZd2epvn37snnzZtatW0dOTg7jxo2r9DWHhIRwxx138MgjjxAfH09hYaH7evLNN9/MnDlzmDdvHoWFheTk5LB48eJSia5Yq1atGDt2LPfffz8zZ84kIyODoqIi1q1bR2Zmpvtcd999N//4xz9ISEgAIC4ujnnz5lUaoz9cd911TJgwgeTkZOLi4pg8ebJ7XWZmJsYY93X1999/n02bNtV6TCLSsChB+6BJkyZ8+eWXTJ06laioKD777DOuvvpq9/oRI0aQnZ1N27ZtOfvss7n00ktL7f/www8zc+ZMoqKieOihh7jkkku47LLLOPHEE+nWrRvh4eGlmlb37t1L//79PcaSm5vLqFGjaNu2LR07diQhIcHdg/mpp56iX79+nHLKKfTp04fTTjvNPZjKiSeeyJgxY7jwwgs54YQTyvXo9uTf//43ffr04YwzzqB169Y8/vjjFBUV0aVLF2bNmsX48eNp164dXbp04aWXXqKoqMjjcR577DFefvlldy/sDh06cO+99zJx4kQGDBgAOD3Te/Towdlnn02LFi248MILvbom76sxY8bQuXNnjj32WC688EKGDBni7lneq1cvRo4cSf/+/enQoQMbN27knHPOqfWYRKRhMcHSLNevXz+7du3acsu3bt3KySefHICIgs9dd93FtddeyyWXXBLoUBqcN998k+nTp1fZya+h0f+nBNS4ls7jiI3QqmtgY6khY8zP1tp+ntapBl2HTJkyRcn5KNm/fz8rVqygqKiIbdu2MWnSJP72t78FOiwRqa6iQkjY6jzWMUrQIh7k5eVx7733EhkZyQUXXMDgwYO5//77Ax2WiFTX2vfgjbOdxzqm7t1mJXIUdOvWTR2/ROqDzMTSj3WIatAiIiJBSAlaREQkCClBi4iIBCElaBERkSCkBC0iIhKElKBryfjx40tNI+lP5513HlOmTKnRvrGxsTRv3rzUhBNHkzfnLzkftfhP8fzZIlI31MnbrM55YSFxKdm1dvzoVhGsGHWBT8d48skn/RSNb7p3786UKVO48MILAejatetRmWyiImXPf95555WbE7s6Nm3axMiRI/n55585fPhwuQkrkpKSuPPOO/n+++9p27YtEyZM4MYbb3SvX7BgAQ888ACxsbGcddZZTJ061T3zl7WWUaNGub8M3XnnnUycONE9HnpMTAy33347q1evpmvXrkyePNldziISZHJS4ecP4KQroVmbQEfjlTqZoONSsol54YpaO373Uf+rtWOLfzVu3JjrrruO+++/n7/+9a/l1j/wwAM0adKEgwcPsm7dOq644gr69u1L7969SUxM5Oqrr2bKlClcddVVPP300wwdOpRVq1YB8Pbbb/P111+zfv16jDFcdNFFHHfccdx3332AMwlJ//79mTt3LnPnzmXIkCHs2LHDPYmGiASRjZ9DViKk7oULngp0NF5RE7ePJk6cSHR0NJGRkfTs2ZMFCxYAMG7cOPeMUTExMRhjeP/99+nSpQtRUVG89dZbrFmzhlNOOYVWrVoxfPhw9zFL7lty/4KCgnLn37VrFxdccAFt2rShbdu23HTTTaSkpAAwbNgwYmNjueqqq2jevDkvvvhiuWPFx8czaNAgWrduTY8ePXjnnXdKxXHddddxyy23EBkZSe/evfE0XjrA2LFjefDBBwFnDuhmzZrx2GOPAZCdnU14eDjJycmlzj969GiWLVvG8OHDad68eakymD9/PieccAJRUVE88MADFU7l2LNnT+6880569+5dbl1mZiZffPEF//rXv2jevDnnnnsugwYN4qOPPgLgyy+/pHfv3lx77bWEh4czbtw41q9fz2+//QbABx98wMiRI+ncuTPR0dGMHDmSqVOnArB9+3Z++eUXnnnmGSIiIrjmmmvo06cPX3zxhcc4f/rpJ/r160eLFi3o0KEDjzzyiHvdtddeS8eOHWnZsiV//vOf2bx5s3vdbbfdxv33389ll11G8+bNOeecczhw4AAjRowgKiqKk046iV9//dW9fffu3ZkwYQK9evUiKiqK22+/nZycHI8xxcfHc80119CuXTuOPfZYXnvtNa/iFamTCvOcx7zMwMZRDUrQPti2bRuTJ09mzZo1pKenM2/ePLp3717h9qtXr2bHjh189tlnjBgxgueff5758+ezefNmZsyYUaOJGKy1PPHEE8THx7N161b27t3rnjLyo48+omvXrsyZM4eMjAx3wizphhtuoHPnzsTHxzNz5kyefPJJ95cMgNmzZ3P99deTkpLCoEGDSiXRkgYOHMjixYsBWLNmDR07dnS/npUrV9KzZ0+ioqJK7fP888/zpz/9icmTJ5ORkVFqSsdvvvmGNWvWsH79embMmFGjKSa3b99OaGgoJ554ontZ8fSaAJs3b6Zv377udc2aNeP444+vcH3ZfY877jgiIyM9ri/r4Ycf5uGHHyYtLY1du3Zx3XXXuddddtll7Nixg4SEBE477TRuuummUvvOmDGD5557jsTERMLCwujfvz+nnXYaiYmJDBkypFzy/Pjjj5k3bx67du1i+/btPPfcc+XiKSoq4qqrrqJv377ExcWxYMECXn31VXc5VxaviBwdStA+CA0NJTc3ly1btpCfn0/37t05/vjjK9z+6aefJjw8nIsvvphmzZpxww030L59e6Kjo/nTn/5UqibkrR49enDRRRcRFhZGu3bteOSRR7xO9Hv37mX58uVMnDiR8PBwTj31VO666y53DRPg3HPP5fLLLyc0NJRhw4axfv16j8fq378/O3bs4PDhwyxdupQ777yTuLg4MjIyWLJkCQMHDqzW6xo1ahStWrWia9eunH/++axbt65a+wNkZGTQsmXLUstatmxJenp6jda3bNmSjIwMrLVV7ltW48aN2blzJ4mJiTRv3pyzzz7bve6OO+4gMjKSsLAwdy0+NTXVvf5vf/sbp59+OuHh4fztb38jPDycW265hdDQUIYOHVrufTN8+HC6dOlC69atGT16NJ9++mm5eNasWcOhQ4cYM2YMTZo04bjjjuPuu+9m+vTpVcYrIkeHErQPevTowauvvsq4ceNo3749119/PfHx8RVu36FDB/fvERER5Z7XpPNWQkIC119/PdHR0bRo0YKbb76ZxETvxpyNj4+ndevWpWqB3bp1Iy4uzv28Y8eO7t+bNm1KTk6Ox6b2iIgI+vXrx5IlS1i6dCkDBw5kwIABrFixokYJuux5a1I2zZs3Jy0trdSytLQ09+ut7vq0tDSaN2+OMabKfct699132b59OyeddBJnnHEG33zzDQCFhYWMGjWK448/nhYtWrhbYEr+Dav7vik5h3i3bt08vif37NlDfHw8rVq1cv+MHz+egwcPVhqviBw9StA+uvHGG1m+fDl79uzBGMPjjz/u8zGbNWtGVlaW+/mBAwcq3PaJJ57AGMOGDRtIS0tj2rRppa7XFvc49qRTp04kJSWVqvXFxsYSHR1do7gHDhzIwoUL+fXXXznjjDMYOHAg8+bN46effuLPf/6zx30qi89XJ554IgUFBezYscO9bP369e7r1b179y7VIpCZmcmuXbsqXF923927d5cqu5LryzrhhBP49NNPSUhI4PHHH2fIkCFkZmbyySefMGvWLObPn09qaioxMTEAFV5z98bevXvdv8fGxtKpU6dy23Tp0oVjjz2WlJQU9096ejpz586tNF4ROXqUoH2wbds2Fi5cSG5uLuHh4URERBAaGurzcU899VSWLl1KbGwsqampTJgwocJt09PTad68Oa1atSIuLo6XXnqp1PoOHTqwe/duj/t26dKFAQMG8MQTT5CTk8OGDRt49913y10D9dbAgQP58MMP6dWrF02aNHHfr33sscdW2LO5svi8Ya0lJyeHvDynA0hOTg65ubmA80Xn6quvZsyYMWRmZrJixQpmzZrFsGHDAKfpeNOmTXzxxRfk5OTw7LPPcsopp3DSSScBcMstt/Dyyy8TFxdHfHw8kyZN4rbbbgOc5H/qqafyzDPPkJOTw1dffcWGDRu45pprPMY5bdo0Dh06REhICK1atQKcSyTp6emEhYXRpk0bsrKy/HJ73n//+1/27dtHUlIS48ePZ+jQoeW2OfPMM2nRogUTJ04kOzubwsJCNm3axJo1ayqNV0SOnjp5m1V0q4havRUqulWEV9vl5uYyatQotm7dSuPGjRkwYABvv/22z+e/6KKLGDp0KKeccgpt27bl8ccfZ/bs2R63HTt2LLfccgstW7akR48eDBs2jFdeecW9/oknnuDBBx/kscce46mnnmLIkCGl9v/000+577776NSpE1FRUTzzzDNcdNFFNYp7wIABZGdnu2vLvXr1Ijw8vMLaMzidkW699VbefPNNhg0bVqonsTf27NnDscce634eERFBt27d3DXRN954gzvuuIP27dvTpk0b3nzzTXctt127dnzxxRcMHz6cm2++mbPOOst9DRbg3nvvZffu3fTp0weAu+66i3vvvde9fvr06dx2221ERUXRtWtXZs6cWeEXke+++45HHnmErKwsunXrxvTp093XkufNm0d0dDStW7fmX//6F2+++Wa1yqCsG2+8kYsvvpj4+HgGDx7MU0+Vv6UkNDSUOXPmMHLkSI499lhyc3Pp2bOnu0NZRfGKyNFjfGlK86d+/fpZT7fwbN26lZNPPjkAEYnUPWUHpqlt+v+UgBrn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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="_WeightGenerator" class="doc_header"><code>class</code> <code>_WeightGenerator</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/simulation.py#L73" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>_WeightGenerator</code>(<strong><code>func</code></strong>, <strong><code>alpha</code></strong>=<em><code>0</code></em>, <strong><code>beta</code></strong>=<em><code>0</code></em>, <strong><code>n</code></strong>=<em><code>100</code></em>) :: <code>_Sampler</code></p>
</blockquote>
<p>Generate a set of weights</p>
<ul>
<li><code>func</code> -- nominal weight distribution function, evaluated on (0,1)</li>
<li><code>alpha, beta</code> -- (default 0,0). Values for $\alpha$, $\beta$.</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Test">Test<a class="anchor-link" href="#Test"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wg</span> <span class="o">=</span> <span class="n">_WeightGenerator</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<span class="n">test2</span> <span class="o">=</span> <span class="n">wg</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span>  <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">wg</span><span class="p">(</span><span class="mi">1000</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span> <span class="n">test2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">test2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Not almost equal: </span><span class="si">{</span><span class="n">test2</span><span class="si">}</span><span class="s1">&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate_cell" class="doc_header"><code>generate_cell</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/simulation.py#L89" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate_cell</code>(<strong><code>wfun</code></strong>, <strong><code>mu</code></strong>, <strong><code>alpha</code></strong>=<em><code>0</code></em>, <strong><code>beta</code></strong>=<em><code>0</code></em>)</p>
</blockquote>
<p>Generate a cell</p>
<ul>
<li><code>wfun</code> -- weight function, or histogram.
  Defined on (0,1)</li>
<li><code>mu</code> -- number of expected weights, on average</li>
<li><code>alpha</code>, <code>beta</code>  -- default 0,0; values for $\alpha$ and  $\beta$ for this cell</li>
</ul>
<p>Returns a dict with:</p>
<ul>
<li><code>n</code> -- actual generated number of weights, from Poisson</li>
<li><code>w</code> -- array of weights</li>
<li><code>S, B</code> -- expected values for $\sum w$ and $\sum(1-w)$, calulated from wfun</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Test with a function peaked at both ends, generate equal signal and background</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary data-open="Hide Code" data-close="Show Code"></summary>
        <summary></summary>
        <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test_gen</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">wfun</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.precision&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Test with alpha=</span><span class="si">{</span><span class="n">alpha</span><span class="si">}</span><span class="s1">, beta=</span><span class="si">{</span><span class="n">beta</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">cell</span> <span class="o">=</span> <span class="n">generate_cell</span><span class="p">(</span> <span class="n">wfun</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span>  <span class="n">alpha</span><span class="p">,</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">beta</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">beta</span><span class="p">)</span>
    <span class="c1">#</span>
    <span class="n">ll</span> <span class="o">=</span> <span class="n">LogLike</span><span class="p">(</span><span class="n">cell</span><span class="p">);</span> 
    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Generated cell info:</span><span class="se">\n</span><span class="si">{</span> <span class="n">ll</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">fit</span> <span class="o">=</span> <span class="n">ll</span><span class="o">.</span><span class="n">fit_info</span><span class="p">(</span><span class="n">beta</span> <span class="ow">is</span> <span class="kc">None</span> <span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mi">2</span> <span class="k">if</span> <span class="n">beta</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">1</span><span class="si">}</span><span class="s1">-D fit info:</span><span class="se">\n</span><span class="si">{</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">fit</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">t</span><span class="p">,</span> <span class="n">sigt</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;flux&#39;</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">alpha</span><span class="p">),</span>  <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;sig_flux&#39;</span><span class="p">]</span>
    <span class="n">check_alpha</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="k">if</span>  <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">&lt;</span><span class="n">tol</span><span class="o">*</span><span class="n">sigt</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;alpha: abs(</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">) &gt; </span><span class="si">{</span><span class="n">tol</span><span class="si">}</span><span class="s1"> * </span><span class="si">{</span><span class="n">sigt</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span>

    <span class="k">if</span> <span class="n">beta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="nb">bool</span><span class="p">(</span><span class="n">check_alpha</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;Failed: </span><span class="si">{</span><span class="n">check_alpha</span><span class="si">}</span><span class="s1"> &#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">t</span><span class="p">,</span> <span class="n">sigt</span> <span class="o">=</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">beta</span><span class="p">,</span> <span class="n">fit</span><span class="p">[</span><span class="s1">&#39;sig_beta&#39;</span><span class="p">]</span>
        <span class="n">check_beta</span> <span class="o">=</span><span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">&lt;</span><span class="n">tol</span><span class="o">*</span><span class="n">sigt</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;beta: abs(</span><span class="si">{</span><span class="n">t</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">) &gt; </span><span class="si">{</span><span class="n">tol</span><span class="si">}</span><span class="s1"> * </span><span class="si">{</span><span class="n">sigt</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="k">assert</span> <span class="ow">not</span> <span class="p">(</span> <span class="nb">bool</span><span class="p">(</span><span class="n">check_alpha</span><span class="p">)</span>  <span class="ow">or</span> <span class="nb">bool</span><span class="p">(</span><span class="n">check_beta</span><span class="p">)),</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">check_alpha</span><span class="si">}</span><span class="s1">  </span><span class="si">{</span><span class="n">check_beta</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">test_gen</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="n">test_gen</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="kc">None</span><span class="p">)</span>
<span class="c1">#test_gen(10, 0, tol=5, quiet=False)</span>
<span class="n">test_gen</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">test_gen</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Test with alpha=0.1, beta=None
Generated cell info:
wtlike.loglike.LogLike:  10559 weights, S 4998.5, B 5001.5
1-D fit info:
counts      10559.000
flux            1.106
sig_flux        0.017
dtype: float64
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="simulate_cells" class="doc_header"><code>simulate_cells</code><a href="https://github.com/tburnett/wtlike/tree/master/wtlike/simulation.py#L126" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>simulate_cells</code>(<strong><code>source_data</code></strong>, <strong><code>wdist</code></strong>=<em><code>None</code></em>, <strong><code>source_flux</code></strong>=<em><code>'&lt;lambda&gt;'</code></em>)</p>
</blockquote>
<ul>
<li><a href="/wtlikesource_data"><code>source_data</code></a> -- a SourceData object, use to get exposure at its position and weight distribution</li>
<li><code>wdist</code>   -- a weight function or histogram; if None, get the source distribution</li>
<li><code>source_flux</code> -- function of MJD time for the counts/day; default 100/day</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary data-open="Hide Code" data-close="Show Code"></summary>
        <summary></summary>
        <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">simcells</span> <span class="o">=</span> <span class="n">pfits</span> <span class="o">=</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">local_sim_cells</span><span class="p">(</span><span class="n">wfun</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">sims</span> <span class="o">=</span> <span class="p">[</span><span class="n">generate_cell</span><span class="p">(</span> <span class="n">wfun</span><span class="p">,</span> <span class="n">mu</span> <span class="p">,</span><span class="n">alpha</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)]</span>
    <span class="n">fits</span> <span class="o">=</span> <span class="p">[</span><span class="n">PoissonRep</span><span class="p">(</span><span class="n">LogLike</span><span class="p">(</span><span class="n">cell</span> <span class="p">))</span> <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">sims</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">sims</span><span class="p">,</span> <span class="n">fits</span>

<span class="k">def</span> <span class="nf">simulation_test</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">funstr</span><span class="o">=</span><span class="s1">&#39;(x-0.5)**2&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ### Test the cell creation</span>
<span class="sd">    </span>
<span class="sd">    Generate {N:,} cells with mu={mu}, alpha={alpha} using the function {funstr}</span>

<span class="sd">    The deviations from the expected norm divided by each cell&#39;s average error:</span>
<span class="sd">    {fig1}</span>
<span class="sd">    Mean and STD of this distribution: {m:.3f}, {sig:.3f}: for a generated Gaussian distribution these wouild be 0 and 1. </span>
<span class="sd">    </span>
<span class="sd">    A validation of the shape is to evaluate the cumulative probability of the over-all mean</span>
<span class="sd">    for each likelihood function. This uses the `poisson.Poisson.cdf` function.</span>
<span class="sd">    {fig2}</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">simcells</span><span class="p">,</span> <span class="n">pfits</span>

    <span class="n">wfun</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;lambda x: </span><span class="si">{</span><span class="n">funstr</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">simcells</span><span class="p">,</span> <span class="n">pfits</span> <span class="o">=</span>  <span class="n">local_sim_cells</span><span class="p">(</span><span class="n">wfun</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
    <span class="n">flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">flux</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pfits</span><span class="p">]);</span> 
    <span class="n">fmean</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="n">alpha</span>
    <span class="k">def</span> <span class="nf">pull</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">f</span><span class="p">,</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>  <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">flux</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">errors</span>
        <span class="n">s</span> <span class="o">=</span> <span class="p">(</span><span class="n">h</span><span class="o">-</span><span class="n">l</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="o">-</span><span class="n">fmean</span><span class="p">)</span><span class="o">/</span><span class="n">s</span>
    <span class="n">pulls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">pull</span><span class="p">,</span> <span class="n">pfits</span><span class="p">)))</span>
    
    <span class="n">m</span><span class="p">,</span> <span class="n">sig</span> <span class="o">=</span> <span class="n">pulls</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">pulls</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;font&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
    <span class="n">fig1</span><span class="p">,</span><span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">num</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">pulls</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">21</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="kc">None</span><span class="p">),</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;pull&#39;</span><span class="p">);</span> 
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">fig1</span><span class="o">.</span><span class="n">width</span><span class="o">=</span><span class="mi">300</span>

    <span class="k">class</span> <span class="nc">CDF</span><span class="p">():</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alpha</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">f</span> <span class="o">=</span> <span class="mi">1</span><span class="o">+</span><span class="n">alpha</span>
        <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">poiss</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">cdf</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">fmean</span><span class="o">=</span><span class="mf">1.1</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">p</span><span class="o">.</span><span class="n">poiss</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">fmean</span><span class="p">)</span>

    <span class="c1">#</span>
    <span class="n">cd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">CDF</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span> <span class="n">pfits</span><span class="p">)))</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">num</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">cd</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">21</span><span class="p">),</span> <span class="n">histtype</span><span class="o">=</span><span class="s1">&#39;step&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;probability&#39;</span><span class="p">)</span>
                            
    <span class="n">fig2</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">locals</span><span class="p">()</span>

<span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
    <span class="n">nbdoc</span><span class="p">(</span><span class="n">simulation_test</span><span class="p">,</span><span class="n">mu</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h3 id="Test-the-cell-creation">Test the cell creation<a class="anchor-link" href="#Test-the-cell-creation"> </a></h3><p>Generate 10,000 cells with mu=50, alpha=0 using the function (x-0.5)**2</p>
<p>The deviations from the expected norm divided by each cell's average error:</p>
<div class="nbdoc_image">
<figure style="margin-left: 5%" title="Figure 1">  <a href="images/simulation_test_fig_01.png" title="images/simulation_test_fig_01.png">    <img src="images/simulation_test_fig_01.png" alt="Figure 1 at images/simulation_test_fig_01.png" width=300>   </a> </figure>
</div><p>Mean and STD of this distribution: -0.096, 1.041: for a generated Gaussian distribution these wouild be 0 and 1.</p>
<p>A validation of the shape is to evaluate the cumulative probability of the over-all mean
for each likelihood function. This uses the <code>poisson.Poisson.cdf</code> function.</p>
<div class="nbdoc_image">
<figure style="margin-left: 5%" title="Figure 3">  <a href="images/simulation_test_fig_03.png" title="images/simulation_test_fig_03.png">    <img src="images/simulation_test_fig_03.png" alt="Figure 3 at images/simulation_test_fig_03.png" width=300>   </a> </figure>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Follow-on:-combine-the-cells-and-fit-the-result">Follow-on: combine the cells and fit the result<a class="anchor-link" href="#Follow-on:-combine-the-cells-and-fit-the-result"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<details class="description">
      <summary data-open="Hide Code" data-close="Show Code"></summary>
        <summary></summary>
        <div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cells</span><span class="o">=</span><span class="p">[]</span>
<span class="k">def</span> <span class="nf">simulation_lightcurve_demo</span><span class="p">(</span><span class="n">source_data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ### Lightcurve generation test</span>
<span class="sd">    </span>
<span class="sd">    This uses the exposure measured for the source {source_name}, and</span>
<span class="sd">    the default time bins to create a light curve assuming a fixed flux</span>
<span class="sd">    and a histogram of weights from the data.</span>
<span class="sd">    {output}</span>
<span class="sd">    </span>
<span class="sd">    {fig}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">global</span> <span class="n">cells</span>
    
    <span class="k">with</span> <span class="n">capture_print</span><span class="p">(</span><span class="s1">&#39;Print out&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">output</span><span class="p">:</span>
        <span class="n">cells</span> <span class="o">=</span>  <span class="n">simulate_cells</span><span class="p">(</span><span class="n">source_data</span><span class="p">,</span> <span class="n">source_flux</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">fits</span> <span class="o">=</span>  <span class="n">fit_cells</span><span class="p">(</span><span class="n">source_data</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="n">cells</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="n">flux_plot</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">fits</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="nb">locals</span><span class="p">()</span>

<span class="k">if</span> <span class="n">config</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
    <span class="n">nbdoc</span><span class="p">(</span><span class="n">simulation_lightcurve_demo</span><span class="p">,</span> <span class="n">SourceData</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">PointSource</span><span class="p">(</span><span class="s1">&#39;Geminga&#39;</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

    </details>
<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>photons and exposure for Geminga: Restoring from cache with key &#34;Geminga__data&#34;
SourceData: Source Geminga with:
	 data:     1,412,008 photons from   2008-08-04 to 2021-04-28
	 exposure: 3,112,161 intervals from 2008-08-04 to 2021-04-28
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>Function simulation_lightcurve_demo failed: binned_exposure() missing 1 required positional argument: &#39;time_bins&#39;
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-17-24d6e6edff75&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">     22</span> 
<span class="ansi-green-intense-fg ansi-bold">     23</span> <span class="ansi-green-fg">if</span> config<span class="ansi-blue-fg">.</span>valid<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 24</span><span class="ansi-red-fg">     </span>nbdoc<span class="ansi-blue-fg">(</span>simulation_lightcurve_demo<span class="ansi-blue-fg">,</span> SourceData<span class="ansi-blue-fg">(</span>config<span class="ansi-blue-fg">,</span> PointSource<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;Geminga&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/mnt/c/users/thbur/OneDrive/work/wtlike/utilities/ipynb_docgen.py</span> in <span class="ansi-cyan-fg">nbdoc</span><span class="ansi-blue-fg">(fun, name, *pars, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    446</span>     <span class="ansi-red-fg"># run it and collect its local symbol table</span>
<span class="ansi-green-intense-fg ansi-bold">    447</span>     <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 448</span><span class="ansi-red-fg">         </span>user_vars <span class="ansi-blue-fg">=</span> fun<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>pars<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    449</span>     <span class="ansi-green-fg">except</span> Exception <span class="ansi-green-fg">as</span> e<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    450</span>         print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">f&#39;Function {fun.__name__} failed: {e}&#39;</span><span class="ansi-blue-fg">,</span> file<span class="ansi-blue-fg">=</span>sys<span class="ansi-blue-fg">.</span>stderr<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-17-24d6e6edff75&gt;</span> in <span class="ansi-cyan-fg">simulation_lightcurve_demo</span><span class="ansi-blue-fg">(source_data)</span>
<span class="ansi-green-intense-fg ansi-bold">     15</span> 
<span class="ansi-green-intense-fg ansi-bold">     16</span>     <span class="ansi-green-fg">with</span> capture_print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;Print out&#39;</span><span class="ansi-blue-fg">)</span> <span class="ansi-green-fg">as</span> output<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 17</span><span class="ansi-red-fg">         </span>cells <span class="ansi-blue-fg">=</span>  simulate_cells<span class="ansi-blue-fg">(</span>source_data<span class="ansi-blue-fg">,</span> source_flux<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">lambda</span> t<span class="ansi-blue-fg">:</span> <span class="ansi-cyan-fg">100</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     18</span>         fits <span class="ansi-blue-fg">=</span>  fit_cells<span class="ansi-blue-fg">(</span>source_data<span class="ansi-blue-fg">.</span>config<span class="ansi-blue-fg">,</span> cells<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     19</span>     fig <span class="ansi-blue-fg">=</span> figure<span class="ansi-blue-fg">(</span>flux_plot<span class="ansi-blue-fg">(</span>config<span class="ansi-blue-fg">,</span> fits<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> width<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">500</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-13-7a152e484a1a&gt;</span> in <span class="ansi-cyan-fg">simulate_cells</span><span class="ansi-blue-fg">(source_data, wdist, source_flux)</span>
<span class="ansi-green-intense-fg ansi-bold">      8</span> 
<span class="ansi-green-intense-fg ansi-bold">      9</span>     &#34;&#34;&#34;
<span class="ansi-green-fg">---&gt; 10</span><span class="ansi-red-fg">     </span>fexp<span class="ansi-blue-fg">,</span> bins <span class="ansi-blue-fg">=</span> source_data<span class="ansi-blue-fg">.</span>binned_exposure<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     11</span> 
<span class="ansi-green-intense-fg ansi-bold">     12</span>     cells<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span>

<span class="ansi-red-fg">TypeError</span>: binned_exposure() missing 1 required positional argument: &#39;time_bins&#39;</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

